"""
Plot the performances of the many different NMF algorithms in a single graph.

We plot the average performance across all 10 attempts for different fractions:
[0.1, 0.2, ..., 0.9].

We use a dataset of I=100, J=80, K=10, with unit mean priors and zero mean unit
variance noise.

We have the following methods:
- VB NMF
- Gibbs NMF
- ICM NMF
- Non-probabilistic NMF
"""

import matplotlib.pyplot as plt
metrics = ['MSE','R^2','Rp']

MSE_max = 10

fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 

# VB NMF
vb_all_performances = {'R^2': [[0.9683884038267335, 0.9646169881339781, 0.9664777405474239, 0.9670287785874833, 0.9624240881702343, 0.9680355038256945, 0.9719307299997457, 0.9629826925022824, 0.9602855205649463, 0.9686705195002323], [0.9653987822562707, 0.9636273772329373, 0.9640673367298059, 0.966066739890249, 0.9633793377232198, 0.9679830987986853, 0.9620785803612693, 0.96082553183301, 0.9661693135001368, 0.9663244944657601], [0.9617930248094203, 0.9642355392384485, 0.9627655889098621, 0.9634443979607432, 0.9596607722421969, 0.9578754064932169, 0.9624082866584496, 0.9538263576952851, 0.9618078543645939, 0.963271891900556], [0.9599720724228168, 0.9589949486255698, 0.9624692958301866, 0.9600292193732625, 0.9586718181830132, 0.9644936230314554, 0.9601011113115265, 0.9582402555176157, 0.9610914150598637, 0.9568099713514397], [0.9510575870994907, 0.953133159466471, 0.9572018168117287, 0.9555886955604032, 0.9562238953027933, 0.9535614336904481, 0.9573252257504995, 0.9524315798133682, 0.9529882110179831, 0.9542089981937436], [0.9415774776278928, 0.9422029887451251, 0.9442776105339002, 0.9389233420029472, 0.9391074784542185, 0.9398795777026226, 0.9422419596592234, 0.9456691395310083, 0.9468243139570814, 0.9398076162947815], [0.9195686981189897, 0.9079605465864389, 0.9078082797884448, 0.9220014020277639, 0.9108287430753849, 0.9037028915591239, 0.912591476608551, 0.918270531533928, 0.9188651953510093, 0.9179806928033701], [0.6920410395599819, 0.6008746365040979, 0.5866015587287425, 0.6186019054564796, 0.5668339370408491, 0.6094993454431883, 0.6132762475293851, 0.49265601928467573, 0.6022068381761583, 0.5266814373578397], [0.498127855582871, 0.46276570487837276, 0.4688479204125017, 0.4643276992518711, 0.485925226956077, 0.47531296302186266, 0.47253208953783354, 0.4575697706092281, 0.32915747811593643, 0.3982904426552035]], 'MSE': [[1.3307806443295218, 1.3860030221750916, 1.3491865404494512, 1.2629440098447298, 1.3525845995372878, 1.3265179972285617, 1.3099149226729085, 1.3020277237977143, 1.4601402263219909, 1.2513376147112634], [1.435952160790894, 1.4303848268759256, 1.3641094842905677, 1.3897974028163187, 1.4508505446515516, 1.3585230505898929, 1.4387783797472564, 1.4369681270833714, 1.3365463498588703, 1.3972466786242712], [1.4560875651344829, 1.4162829303391684, 1.4619786232698355, 1.4634447984464445, 1.419116277117898, 1.5617928762366986, 1.4340335524769894, 1.5602103918913377, 1.4913875309554596, 1.434913867582116], [1.6041488253096432, 1.5757054761400267, 1.51638250689182, 1.6144003105634825, 1.5879065992141508, 1.5553875416864309, 1.5117231920229905, 1.6480661011771951, 1.6104213492947808, 1.5746276392092045], [1.8249532954410042, 1.8684675176149066, 1.6884323641027121, 1.7357984294610043, 1.7600831122286691, 1.7602824360794105, 1.7541479574284402, 1.8496812642592837, 1.8017840734869119, 1.8028886582045112], [2.2830756844552869, 2.3381965848102286, 2.216514115860623, 2.3093143677485344, 2.3415264238240638, 2.2899284412993794, 2.2271667169283544, 2.1963148167304456, 2.0830955631671704, 2.4138472512538964], [3.1232560756434995, 3.5500566611187123, 3.5434235337850692, 3.1256896633925706, 3.5094838277923319, 3.7894116899659496, 3.3721896132320386, 3.1328631528840871, 3.1814614927189346, 3.2612035339698324], [12.285753990084888, 15.358471185031494, 16.052806094752338, 14.905585025277116, 16.848948739652801, 15.506789499794692, 14.846760598929515, 20.165428714525419, 15.641343624014961, 18.888603197701336], [19.91181911887352, 21.089792265365787, 20.820169006409735, 21.111090007086695, 20.383431673137796, 20.692187943371938, 20.931366119129279, 21.338393635409702, 26.574615383488879, 23.191480741378562]], 'Rp': [[0.98417814296283501, 0.98223400580549158, 0.98310326759249378, 0.98340722606591879, 0.98109337471923375, 0.98404390169079525, 0.98592775532569599, 0.98131947992398216, 0.97998468118843007, 0.98422609008714801], [0.9826101986875232, 0.98164905167945748, 0.98193816637754328, 0.98290389426688474, 0.98154124970139101, 0.98390533314231476, 0.98101064425676598, 0.98026353532428501, 0.98297973175637066, 0.98305830615657197], [0.98078317148555072, 0.98198414505700715, 0.98122073773732377, 0.98155713977161774, 0.97963966020841486, 0.97874970585541088, 0.98104144030097185, 0.97667120348535452, 0.98076429936402731, 0.98151649299554744], [0.97994720265290991, 0.97937813547381558, 0.98107978700989862, 0.97983062508002172, 0.97919011307640369, 0.98208889140778566, 0.97990775152411236, 0.97892552090575269, 0.98035357770873099, 0.97823011129973625], [0.97527494390058556, 0.97661348931923153, 0.97847670949617727, 0.97768219832746694, 0.9778798337102893, 0.97658532879410387, 0.97851222466341137, 0.97598467728753147, 0.97623619637760939, 0.97694115727467978], [0.97039259977702308, 0.97073350305394834, 0.97179438232063309, 0.96901986600092904, 0.96919448091426885, 0.96948570832841707, 0.9707251134658279, 0.97246199162764579, 0.97310098700035219, 0.9694711588036119], [0.95912297665582935, 0.95332670849063539, 0.95288766098517352, 0.9602238588797064, 0.95446281935606847, 0.95093148902935831, 0.95553021872522659, 0.95856275340635955, 0.95885273967483775, 0.95837112445540062], [0.83309959117472532, 0.78392590768509252, 0.78228908789976048, 0.79230555909437228, 0.77539309469738738, 0.79410490646410281, 0.7990139950108649, 0.73383952871177027, 0.78463353986423079, 0.74223137952499108], [0.73535887538412503, 0.72700259454644678, 0.72810312108849651, 0.73051322809824903, 0.73276297324422102, 0.73165859759103224, 0.73380231876238378, 0.71376455057499144, 0.67766815789763035, 0.70196034943723151]]} 
vb_average_performances = {'R^2': [0.96608409656587535, 0.96459205927913449, 0.96110891202727733, 0.96008737307067504, 0.95437206027069299, 0.94205115045088017, 0.91395784574530037, 0.5909272965081398, 0.4512857151021758], 'MSE': [1.3331437301068518, 1.4039157005328922, 1.4699248413450432, 1.5798769541509725, 1.7846519108306853, 2.2698979966077983, 3.3589039244503018, 16.050049066976456, 21.604434589365191], 'Rp': [0.98295179253620246, 0.98218601113491089, 0.98039279962612258, 0.97989317161391676, 0.97701867591510871, 0.97063797912926564, 0.9562272349658596, 0.78208365901272991, 0.72125947666248069]}

# Gibbs NMF
gibbs_all_performances = {'R^2': [[0.9625030326397841, 0.9706451677249774, 0.963217707895298, 0.9654064278239094, 0.9643691045132832, 0.9672850759760732, 0.9678050734114245, 0.9700054162557077, 0.9705148382516579, 0.9639043626891819], [0.9652178740692119, 0.9635050992610616, 0.9657536717024912, 0.964522008466088, 0.9667065431225558, 0.9632625900673261, 0.9647633303828732, 0.9616172252261357, 0.9679151936920822, 0.964703774483381], [0.9629037141883738, 0.9608822891589637, 0.9656496888280449, 0.9633602441053563, 0.9580945073694958, 0.9669982233351793, 0.9653941908930447, 0.9632441314624717, 0.9632777036861077, 0.962266323182308], [0.9579299402036267, 0.9598158920752131, 0.9600909536153182, 0.9603853977612107, 0.9586308199546364, 0.960102646967832, 0.9598887021643804, 0.9576088800122263, 0.957762572220755, 0.9602726667571723], [0.9533424107044418, 0.954540844669128, 0.9527718533303425, 0.9522647284709008, 0.9515463243684358, 0.9534377017421702, 0.9546347761473944, 0.9527172602202294, 0.9533165949889422, 0.9553071857604678], [0.9431804130943913, 0.9436343468492804, 0.9446919305820516, 0.9434464097304541, 0.9422055576268311, 0.9421622537817048, 0.9409263728884416, 0.9398447610968322, 0.9429289265571029, 0.9374073592359273], [0.916524382023979, 0.9043779074524534, 0.9183809333829188, 0.900249099866099, 0.9042200028924992, 0.9083023628121983, 0.90897818251417, 0.9045388804986353, 0.9191668777556593, 0.8818574754459069], [0.6671567942933867, 0.6151737193408983, 0.6219931021607186, 0.39224588120077664, 0.6195966459142095, 0.7219978088246659, 0.6874080966837983, 0.6850285173577916, 0.6722454012900922, 0.636281137745908], [0.3675212826444849, 0.23977033459351604, 0.3131819547995017, 0.3195825910173784, 0.4211396095429468, 0.060084743933808804, 0.39875730727715586, 0.3154303760209578, 0.20980645235433315, 0.2535522654865773]], 'MSE': [[1.4080635301945019, 1.3834441410282272, 1.43846832498792, 1.3252201775103192, 1.289768927310458, 1.3907245622336175, 1.4628305532080657, 1.304976056368647, 1.3194413200996815, 1.3479391381887493], [1.3481063483908744, 1.442155660963143, 1.3523061894096968, 1.5024222091668862, 1.3857698541563856, 1.4682058869615482, 1.4249816213159914, 1.4567483413995783, 1.3323855931001123, 1.4217683300724258], [1.3827222803883148, 1.5751554279148783, 1.4061987209744606, 1.509455688815255, 1.507625578272743, 1.3824379048291175, 1.4234381842926758, 1.4963368471226333, 1.4396804186110883, 1.477881704853435], [1.5801209153324454, 1.5973218269774465, 1.6351795675932914, 1.6562019256517353, 1.6087627620105758, 1.5854058215600058, 1.5514288060190793, 1.7075562805566704, 1.6438600388615745, 1.5828742414373866], [1.7576436997384206, 1.8051022217662807, 1.8412551180472241, 1.8383194618348511, 1.8225252368084555, 1.7994736800937963, 1.7936386434290248, 1.8750743464116044, 1.8394212504554981, 1.7891029799471618], [2.2223513017617433, 2.2627072329745261, 2.2574489146867021, 2.2473658939138743, 2.321469558832471, 2.3134088317317745, 2.3801439793355135, 2.3410716909025076, 2.2015953734873492, 2.376271466983384], [3.3831137298395082, 3.7684340128891258, 3.1093920809466207, 3.8128585112652775, 3.8571548660298505, 3.612694885489443, 3.5642514383519068, 3.7040733323563302, 3.1787849159740511, 4.6733030187818558], [13.279569274385175, 15.203207789979999, 14.769243083707813, 23.774445419182403, 15.020806911986938, 11.009636346242466, 12.537176264539049, 12.528002453462435, 12.80758362532964, 14.115115429959346], [24.777056197673051, 30.043140977870845, 26.97455437847875, 26.977072284106811, 23.030147899288796, 36.435247069949099, 23.845359136623536, 27.105507744658343, 30.575962892150574, 29.506229606962588]], 'Rp': [[0.98112907943488292, 0.98525417987384933, 0.98147935507119177, 0.98275775056054115, 0.98203948996015467, 0.98352304605683794, 0.98379250854491329, 0.984964701042218, 0.98516016083518776, 0.9819138352749941], [0.98250662588756255, 0.98172420267800842, 0.98279751393473935, 0.98217124196125649, 0.98349853736107673, 0.98150198314314674, 0.9822598925141427, 0.98067597895876679, 0.98389870591089801, 0.98223219168438902], [0.98140167903506048, 0.98030883029687921, 0.982709405522598, 0.98159461273400095, 0.97895560271084825, 0.98345588910478432, 0.98287061242843787, 0.98149631542050431, 0.98150248690828956, 0.98096674913419646], [0.97876283666103892, 0.97974855069099387, 0.97994153136465889, 0.98005826843124322, 0.97917150451239099, 0.98000849015850999, 0.97984798411581941, 0.97867791253219261, 0.9786565803073719, 0.9800136677189899], [0.97654729362476933, 0.97722039322632015, 0.9763397785691339, 0.97593222594460827, 0.97558903597236113, 0.97661128767616934, 0.97720816479140737, 0.97662587249773991, 0.97651198444980425, 0.97745215330403623], [0.97177140810030704, 0.97165361246740878, 0.97222485268945658, 0.97179840668585771, 0.97077494046407375, 0.97084121265223111, 0.97016293403649922, 0.96996475459882969, 0.97109772640221903, 0.96856794941700564], [0.95767311191108817, 0.95107568848913859, 0.95961178954209159, 0.94961968749910031, 0.95235107854603918, 0.95400452406913894, 0.95405643445250732, 0.95116417152877031, 0.95933894276955078, 0.94063567824205208], [0.82495235207159523, 0.81003828716231907, 0.80807134161041672, 0.74265169909681406, 0.81048620429537788, 0.85837090993758092, 0.84449553510914677, 0.83915780946639851, 0.83280220624881118, 0.82379152767400254], [0.73184437699249605, 0.70574964090467174, 0.72927832469092224, 0.68654459784768007, 0.73612620404475915, 0.65664491003305059, 0.74881349033900768, 0.72468877844848423, 0.68276566639679837, 0.73287909775681781]]} 
gibbs_average_performances = {'R^2': [0.96656562071812968, 0.96479673104732055, 0.96320710162093448, 0.95924884717323722, 0.95338796804024528, 0.94204283314430182, 0.90665961046445198, 0.63191271048122455, 0.28988269176706605], 'MSE': [1.3670876731130188, 1.4134850034936641, 1.4600932756074601, 1.6148712186000211, 1.8161556638532321, 2.2923834244609842, 3.6664060791923974, 14.504478659877526, 27.927027818776242], 'Rp': [0.98320141066547717, 0.98232668740339868, 0.98152621832956011, 0.97948873264932101, 0.97660381900563498, 0.97088577975138879, 0.95295311070494759, 0.8194817872672463, 0.71353350874546884]}

# ICM NMF
icm_all_performances = {'R^2': [[0.9641562292087671, 0.9645010597069835, 0.9646901647940758, 0.9655401108016127, 0.9674530879915644, 0.9569122349718484, 0.9659676744219805, 0.961823331494361, 0.9588167717859395, 0.9677799213393541], [0.9653848809650548, 0.9620621930993009, 0.9640008426923107, 0.9650573608415195, 0.9626176887374777, 0.9678938358100784, 0.9656336306429064, 0.9658874195378, 0.9652151210503097, 0.9644450928693796], [0.9606542287614818, 0.9630774013973531, 0.9614947488092904, 0.9638428551389013, 0.9639431225149693, 0.9613333243745601, 0.962589151034413, 0.9622937077169137, 0.9648323744216998, 0.9627840868558615], [0.9573713059999577, 0.9603047794875761, 0.9604105518457282, 0.9599222108792298, 0.9583717438039353, 0.9609764263877065, 0.9584665615810277, 0.9594916076854826, 0.9618604428969201, 0.9584578815288594], [0.951945859286866, 0.9533250945881767, 0.9535805461601896, 0.951957301424992, 0.9530018526223901, 0.9507743945297216, 0.9505581120807776, 0.9515567288962331, 0.9512478253095026, 0.9519146032448463], [0.9404094188854749, 0.9336945507298016, 0.9350026335791896, 0.9400610379503956, 0.9383058550262751, 0.9405440166884551, 0.9421276539958618, 0.8453273983404234, 0.9409229351771975, 0.9412159509927134], [0.8373647489515432, 0.6593600787392411, 0.3857013908734044, 0.4285987221054517, -0.09804272884520082, 0.704092916823509, -0.3849876169183244, -0.6305356663474557, 0.5457178293698122, 0.24269210696018828], [-1.5236351313248049, -1.1687330885459528, -9.27866000769371, -2.5434674027132806, -3.108572831381043, -6.084027307204444, -0.8383840755797667, -2.2961562260049657, -3.763559201216636, -6.4064604561489675], [-48.087115511858926, -4.988536637651729, -13.588410241499483]], 'MSE': [[1.4157376128967303, 1.4172152810382146, 1.2982624221924366, 1.3660878392107088, 1.29413011643181, 1.3937119136567291, 1.24122050660739, 1.3714583484799947, 1.374719102657656, 1.225411413289351], [1.4143535690923141, 1.4024816442870915, 1.420143308333216, 1.3572228408037963, 1.4589553808393663, 1.4043078663157107, 1.3696816220228198, 1.4528537591434383, 1.3958140405975161, 1.4628392963149992], [1.4682991369101885, 1.4434980448246368, 1.5286511631346114, 1.4292470328290885, 1.4619574485924256, 1.4308418958806917, 1.4546923586872642, 1.4837337933507222, 1.4480701623668859, 1.4243120664506492], [1.6460829038655944, 1.5837355038774057, 1.5927933797650677, 1.5862983946889129, 1.6652205168830831, 1.5664651939031229, 1.61242928487742, 1.5801685343517209, 1.5349852001341278, 1.5911111352916367], [1.8004373299006959, 1.8506793815389737, 1.8387518473935809, 1.846188806961079, 1.8446840474272586, 1.9303648656261241, 1.8972671682840647, 1.9406695749130896, 1.8265258261696342, 1.8802983701989302], [2.4441134369396527, 2.5932139926844742, 2.5537570058304828, 2.3717359543163106, 2.3452921965481108, 2.4353039143070059, 2.2666633352411889, 5.9790532416995124, 2.3370397315869256, 2.3110464318179762], [6.2394953479314488, 13.784593279253274, 24.413549114187326, 22.074435636666941, 43.006418241923775, 11.78336042825334, 54.463352382775149, 63.852968595139409, 18.25734771363199, 28.910225414586353], [100.60746321557373, 87.117268686590904, 404.89917231840286, 139.77827007624774, 158.47479196109543, 283.0133371912288, 71.376220623944931, 131.6916560675991, 191.18767262917342, 297.25740371548216], [1962.6021086913352, 236.41109535417542, 583.85373463404892]], 'Rp': [[0.98211399540885458, 0.9821227854040846, 0.98224536989589228, 0.98266020829173428, 0.9836975174573801, 0.97833175537651063, 0.98284115656909854, 0.98073659923236323, 0.97928574344306818, 0.98376995424850522], [0.98255006826066837, 0.9809685309744689, 0.98191100095727535, 0.98240571325463921, 0.98117553577447336, 0.98383571689906058, 0.98268736743627849, 0.98295919555072864, 0.98253006918037389, 0.98211474189875991], [0.98012996319114154, 0.98142018962040667, 0.9807022680799482, 0.9818483602300967, 0.98189431679521122, 0.98047878687940315, 0.98123053528262116, 0.98104903560110901, 0.98230494368673038, 0.98122471738100714], [0.9786508632789751, 0.98002263850602911, 0.98003114162395899, 0.97978978703341157, 0.97903523697636363, 0.98041445367683056, 0.97926601139432823, 0.97962643078523393, 0.98084491811568064, 0.97911020775076651], [0.97595978557637297, 0.97647133340668057, 0.97662253254122089, 0.97575834842200704, 0.97635694617897473, 0.9754266207324167, 0.97514719743087108, 0.97562755309844695, 0.97549323954607658, 0.9759300551796849], [0.97017433106623752, 0.96712258530749773, 0.96757989375787468, 0.97009080698995864, 0.96896519339012244, 0.96994755012493528, 0.9710280832358994, 0.92312611736458228, 0.9703429260514721, 0.97039291603957767], [0.92262161908527718, 0.84441489551609283, 0.76553020553213313, 0.76721541794359593, 0.67650970147110256, 0.86231090261438936, 0.6142044177361794, 0.59485843617261747, 0.80863991123813217, 0.74642143976216602], [0.42402180869745382, 0.48701152422577909, 0.33006379185886042, 0.49131708735976293, 0.43358285957091047, 0.36538850849807497, 0.54465204022425162, 0.43791219015955979, 0.42742608847350999, 0.33937256120533654], [0.25033726482988228, 0.47484548419016576, 0.37271089170747973]]}
icm_average_performances = {'R^2': [0.9637640586516486, 0.96481980662461386, 0.96268450010254436, 0.95956335120964231, 0.95198623181436959, 0.92976114513657893, 0.2689961781712169, -3.7011655727813575, -22.22135413033671], 'MSE': [1.3397954556461018, 1.413865332775027, 1.4573303103027164, 1.5959290047638093, 1.8655867218413433, 2.763721924097164, 28.678574615434901, 186.54032564853392, 927.62231289318652], 'Rp': [0.98178050853274923, 0.98231379401867258, 0.98122831167476754, 0.97967916891415785, 0.97587936121127528, 0.96487704033281574, 0.76027269470716852, 0.42807484602735002, 0.3659645469091759]}

# Non-probabilistic NMF
np_all_performances = {'R^2': [[0.9691254745756863, 0.9633516647834863, 0.9625378123937329, 0.9639729574347011, 0.9708667597353263, 0.9623323030008397, 0.9642568532283987, 0.9620800370464972, 0.9668372779043717, 0.967522028630827], [0.9596414798585385, 0.960648248890271, -2.868297457611765e+22, 0.9218846536992177, 0.9553380225272833, 0.9033024523787523, 0.9577286625659229, 0.9634255497099328, 0.9638157082343298, 0.9642478519675127], [0.9585386758992782, 0.9629797556103429, 0.9603874912513723, 0.9606530925390091, 0.9520245872472288, 0.9562689323871152, 0.9608728305400652, 0.9549997334210606, 0.9592991143733417, 0.953523723510715], [0.9528500946759112, 0.9520318877395053, 0.9318118457163103, 0.9560912697218997, 0.9513306901289753, 0.9554649319755996, -1.8964790014198816e+22, 0.9508603134495773, 0.9511793525344068, 0.9464202206738923], [0.9403400455425556, 0.9370168521938504, 0.9365744694014086, 0.946222978752346, 0.9370039631196718, 0.9388162362775407, -1.269352469598793e+28, 0.9321536451303915, 0.9375195960634116, 0.9456375859907521], [0.8527262774463393, 0.8495462600213726, 0.897702355878298, 0.9056153597918639, -4.529478150237715e+20, 0.8014097601801279, 0.8612578262759117, 0.41204579589335477, 0.8779816435481624, 0.8618957706527776], [0.4863203469445434, -1.1300600811244412e+40, 0.3208329737596357, 0.49639383707079154, 0.5613697000683835, -9.408378605392025, 0.5814183726048874, 0.426875286066539, 0.38557464489049276, 0.6153337432958685], [-0.4269498970154475, -1.4331381971904569, -2.0662684359198185, -0.5106164927320507, -3.6012073112126304, -0.8047789231961096, -1.2738045850381985, -0.3559863471098499, -0.47592810692249543, -0.6303212124849187], [-0.18584588336589714, -0.4193538672886712, -0.17178062711953834, -0.2523190784153626, -0.23975088889232654, -1.5511667351101472, -0.10413897036137199, -0.27590387531924776, -0.16384171368768108, -0.31760510660326036]], 'MSE': [[1.3312892104648717, 1.4071811532046377, 1.4317190136571645, 1.4129315889025396, 1.3549592842438571, 1.483147999700019, 1.3665241895237261, 1.4751126474718794, 1.4319702836944068, 1.2570410968246852], [1.6512221244579126, 1.6628607717512551, 1.0151021186330168e+24, 3.1003327826899225, 1.6552129134699021, 3.9485834206169481, 1.6339455395920544, 1.4871189545115391, 1.50352088205288, 1.5062151943499944], [1.6031040059734127, 1.5047349680985247, 1.6115240232633385, 1.5371031240857753, 1.7526859974601792, 1.7890294497524235, 1.5678982328202962, 1.7439065671673988, 1.7184844723149508, 1.6044866986185355], [1.8872402550996319, 2.0101139868212665, 2.8170974078374318, 1.8884093670070556, 1.946749309758427, 1.7934494834376913, 7.0317255515350879e+23, 1.8902321342621802, 1.9635963045018634, 2.0747134839020371], [2.330206732650435, 2.3542600578505275, 2.415345500855099, 2.0945734473477207, 2.4232738709541755, 2.4884917719925896, 4.8335381089590484e+29, 2.4819461907571174, 2.432821171183432, 2.1553692446222246], [5.6132256725732379, 6.085981807926756, 3.9241283573624508, 3.6806414290877485, 1.7961869800828477e+22, 7.9943960009921167, 5.2392731427243184, 23.570235689141061, 5.0771840695803965, 5.534737029322307], [19.975867233933876, 4.4525715370544503e+41, 27.373112356315989, 19.329307148620661, 17.446158988743996, 416.94434620042216, 16.152276459470119, 23.48662795981657, 23.453082784409037, 15.344446051020212], [58.123843057107052, 96.273343571958961, 119.51558414119452, 59.829149632648459, 183.0861772083606, 71.219099947075179, 91.054354386439712, 53.054179311588989, 59.252765213340645, 63.426342304319576], [46.216482006171972, 55.06865000754393, 45.940946966758467, 48.616993290967564, 48.627658985925024, 100.94208305739855, 43.622816947243201, 50.136764141636604, 46.30212994994514, 51.515072914880314]], 'Rp': [[0.9844454176278018, 0.9816854896378886, 0.98127914696258356, 0.98187816079810675, 0.9853884967744202, 0.98102338505245623, 0.98202524565979377, 0.98090287276259758, 0.9832990380829254, 0.98365755883228012], [0.97963008556380826, 0.98020164214913896, 0.032779108299340325, 0.9608617256598192, 0.97746115158684022, 0.95203627233714627, 0.97865500794092808, 0.98157742498589351, 0.98175426855537651, 0.98199863941884369], [0.97936463020344611, 0.98135967269780977, 0.98002389607971108, 0.98015388507238843, 0.97580412479623535, 0.97816074038643497, 0.98042030383988454, 0.9774827259614014, 0.97956255287835237, 0.9767925515611714], [0.97630463643178234, 0.97579582143852384, 0.96549508530210704, 0.97793446811372586, 0.97544735548545225, 0.97766099699270703, 0.022107809623075722, 0.97528283191700971, 0.97558893251588719, 0.97297691815579856], [0.96985504761566155, 0.96831446514787656, 0.96789070739814653, 0.97315279626579032, 0.96852618837044568, 0.96931848734461334, -0.01949860738833982, 0.9660508072375662, 0.96874848049947282, 0.97271401053242534], [0.92886804740031426, 0.92509518849553762, 0.94866421885602481, 0.9539262821384622, 0.037645113577873694, 0.90297241389285898, 0.93134708460707805, 0.77902800821445917, 0.93783473937996575, 0.93100667668554948], [0.7834922643926735, 0.0087455547269864979, 0.7048854279619462, 0.77366583456545324, 0.7939247938910019, 0.29142910165142394, 0.81474716664425628, 0.75863339811022323, 0.75342910080247394, 0.82477129760552725], [0.52169899306006817, 0.43586645473909136, 0.45058831694787943, 0.5309385984251257, 0.39464224127849762, 0.51806949658165247, 0.45899527486872638, 0.57121892903875626, 0.58128538812576491, 0.54775418046611846], [0.58122659296729884, 0.51138667540951033, 0.57710955162335753, 0.56112090856719099, 0.52874557142528533, 0.46356585640488002, 0.55165626892574771, 0.53742479650791075, 0.55688364765451825, 0.55830719800723994]]} 
np_average_performances = {'R^2': [0.96528831687338668, -2.8682974576117652e+21, 0.95795479367795289, -1.8964790014198816e+21, -1.2693524695987931e+27, -4.5294781502377148e+19, -1.1300600811244411e+39, -1.1578999508821979, -0.36817067461635045], 'MSE': [1.3951876467687785, 1.0151021186330168e+23, 1.6432957539554836, 7.0317255515350881e+22, 4.8335381089590488e+28, 1.7961869800828478e+21, 4.4525715370544501e+40, 85.483483877403387, 53.69895982684708], 'Rp': [0.98255848121908562, 0.88069553264971334, 0.97891250834768351, 0.87945948559760689, 0.87050723830236565, 0.8276387773248125, 0.6507723940351966, 0.50110578735316813, 0.54274270674929403]}



# Assemble the average performances and method names
methods = ['VB-NMF', 'G-NMF', 'ICM-NMF', 'NP-NMF']
avr_performances = [
    vb_average_performances,
    gibbs_average_performances,
    icm_average_performances,
    np_average_performances
]

for metric in metrics:
    plt.figure()
    #plt.title("Performances (%s) for different fractions of missing values" % metric)
    plt.xlabel("Fraction missing", fontsize=16)
    plt.ylabel(metric, fontsize=16)
    
    x = fractions_unknown
    for method, avr_performance in zip(methods,avr_performances):
        y = avr_performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', marker='o', label=method)
    plt.legend(loc=0)  
    
    if metric == 'MSE':
        plt.ylim(0,MSE_max)
    else:
        plt.ylim(0,1)