"""
Plot the performances of the many different NMTF algorithms in a single graph,
as we vary the fraction of missing values

We plot the average performance across all 10 attempts for different fractions:
[0.1, 0.2, ..., 0.9].

We use a dataset of I=100, J=80, K=10, with unit mean priors and zero mean unit
variance noise.

We have the following methods:
- VB NMTF
- Gibbs NMTF
- ICM NMTF
- Non-probabilistic NMTF

"""

import matplotlib.pyplot as plt
metrics = ['MSE']#['MSE','R^2','Rp']

MSE_max = 30

fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 

# VB NMF
vb_all_performances = {'R^2': [[0.9971837222867026, 0.9977798608527287, 0.9959587181587914, 0.9955782668612875, 0.9979165189205146, 0.9982014751965419, 0.9976803891401673, 0.9982908763622557, 0.9975848120462552, 0.9977972352960411], [0.9978328481035892, 0.9977203219745328, 0.9951621283758934, 0.9978930799530433, 0.9979762013486685, 0.9978477416146811, 0.9975806957842632, 0.9978215372049104, 0.9977702601373106, 0.9978311949178683], [0.9975991297870219, 0.9953871635458862, 0.9979927081826246, 0.9981558054320991, 0.9979550152697456, 0.9977828625456324, 0.997624944002126, 0.9957051107513721, 0.9976169289880684, 0.9956418843849324], [0.9952962611776615, 0.9951944602075063, 0.9953212749581732, 0.9976892584164087, 0.9976281327027932, 0.9977995264349202, 0.9953582083539202, 0.9976131090483124, 0.9952940588261312, 0.9976517536685652], [0.9952301032074211, 0.9951942841207814, 0.9955621023150253, 0.9952544349453484, 0.9976566787393257, 0.9955165972745983, 0.9949679632854403, 0.9976287343346854, 0.9722611289348965, 0.9744704372886972], [0.9973908896924819, 0.9721187930641384, 0.994754988195573, 0.974117907849793, 0.9726026631381431, 0.9693080973259954, 0.9606486295233974, 0.9727052188224292, 0.9732831396810099, 0.972679331557322], [0.9694924723898535, 0.9657663242228386, 0.9700990353811061, 0.96802914248208, 0.967561235371776, 0.9711769621372333, 0.9632729581085516, 0.9683288828624574, 0.9659489656125704, 0.9703934222533287], [0.9593112989581665, 0.9609115518107277, 0.9494695654350479, 0.9637130374690138, 0.9648418168859251, 0.9565352927178119, 0.955241465603398, 0.9629925741904236, 0.9583566663131274, 0.9930089094728662], [0.8939564580905974, 0.9034941626582259, 0.9310407174315062, 0.9344501547925375, 0.9094479969074324, 0.9006794582943899, 0.8914657574661758, 0.9289820480675609, 0.8835745751721158, 0.9122137216737115]], 'MSE': [[1.2742834620024839, 1.1518811864789373, 2.131931735068179, 2.1475493103381389, 1.0701444643348739, 1.104317627983789, 1.1289636864227581, 1.1395722903708732, 1.1004284515528457, 1.111841455091453], [1.2457426934917377, 1.1232782671564008, 2.6252856584560011, 1.1280400486620978, 1.1807213612939913, 1.1243917934706915, 1.1436891005844465, 1.1905487347943602, 1.1342840963670442, 1.1828958879803657], [1.1914259969965493, 2.9068209331145618, 1.2328381115583686, 1.1422288814581059, 1.2082507749006857, 1.2011969061835619, 1.2415829004775136, 2.5623045259072086, 1.2100889467353351, 2.4656848785659093], [2.6225667118927141, 2.6902496564958613, 2.645972196070622, 1.3117705862270852, 1.3069195177658079, 1.2757795972235979, 2.6513521990465772, 1.2892495387609222, 2.5755626237618117, 1.3270287753133077], [2.6445151006234711, 2.7469269182625959, 2.7809814202581395, 2.7972335341382499, 1.3401919084108094, 2.5138202838114956, 2.7894912659245512, 1.3249177957071068, 15.942657973956123, 15.803432115033603], [1.4731288391619557, 16.693913293825815, 2.9910227595517429, 15.243537069515929, 16.231711317875341, 18.058677676402247, 23.168042825608261, 15.157752650136711, 14.824343036707775, 14.953464654965162], [16.714878306087328, 20.090434574287034, 16.923196248287741, 17.733532424792426, 18.163461288899338, 16.690955635519785, 20.381459985732974, 16.560274714266548, 19.366611735978879, 17.549892254827853], [22.911489370892777, 22.83746259561245, 28.9411568347086, 21.305228231982163, 20.25222745635439, 23.945719522618489, 25.974393533176418, 21.890539471022702, 23.518856659812336, 4.1208287346716048], [61.60050358136985, 54.39575479958453, 39.822655441993675, 36.815172011939843, 52.426834958169664, 56.347726780147411, 61.461065148179017, 41.056886970245195, 68.247820638790074, 51.640266906574489]], 'Rp': [[0.99859093517625497, 0.99889632447019605, 0.99798186149413781, 0.99778862987007244, 0.99896256110131942, 0.99910084695277679, 0.99884097220888568, 0.99914649200246308, 0.99879241102785088, 0.99890157515124622], [0.998919472849083, 0.99886009470133474, 0.99757834523499722, 0.99894652654530802, 0.99898760875925618, 0.9989275761930787, 0.99879211580230509, 0.9989103718262029, 0.99889116888971718, 0.99891662925349745], [0.99880130430046299, 0.9976956903675257, 0.9989969540353919, 0.999077721072964, 0.99897715531935727, 0.9988912678048395, 0.99881309905418003, 0.99785075879590646, 0.99880974030868885, 0.99781865809229453], [0.99765060815349071, 0.99759723629745156, 0.9976600028771121, 0.99884400675903606, 0.99881588740266991, 0.99889977206079472, 0.99767954552142979, 0.998807199595944, 0.99764620630143108, 0.99882897845936647], [0.99761520330929676, 0.99759567767452484, 0.9977797055250921, 0.99762610071089663, 0.99882869375937688, 0.99775594721651339, 0.99748223985928341, 0.99881512487838009, 0.98610096876402487, 0.98717968031919556], [0.99869560755763909, 0.98598027220263451, 0.99738018077226132, 0.98698883490203204, 0.98634614551367727, 0.9845602511051571, 0.98091140389827192, 0.98628687930459324, 0.9866194325361618, 0.98629628118692136], [0.98467602347309446, 0.982757064168582, 0.98502224675366434, 0.98390315286755126, 0.98371064235811179, 0.98548388348978022, 0.98153687146245971, 0.98404286256132911, 0.98310456741863439, 0.98508650967016942], [0.97991667036920427, 0.9803686307615741, 0.97560361847363508, 0.98172862057615962, 0.9823703407390022, 0.97820450369267342, 0.97795542403960867, 0.98133758067765264, 0.97978524594646976, 0.99650121068652409], [0.94639337903205767, 0.95228771647356514, 0.96678842762300632, 0.96789998070343486, 0.95499762210446493, 0.9500937873164581, 0.94546231276825332, 0.96543156879718361, 0.94048149302835193, 0.9553228635931772]]} 
vb_average_performances = {'R^2': [0.99739718751212847, 0.99754360094147587, 0.99714615528895079, 0.9964846043794392, 0.99137424644462191, 0.97596096588502823, 0.96800694008217947, 0.96243821788565087, 0.9089305050554255], 'MSE': [1.3360913669644332, 1.3078877642257136, 1.6362422855897798, 1.969645140255831, 5.0684168316126144, 13.879559412375096, 18.017469716867993, 21.569790241085194, 52.381468723699378], 'Rp': [0.99870026094552034, 0.99877299100547801, 0.99857323491516115, 0.99824294434287264, 0.99567793420165851, 0.98800652889793505, 0.9839323824223376, 0.98137718459625023, 0.95451591514399536]}

# Gibbs NMF
gibbs_all_performances = {'R^2': [[0.998185524304205, 0.9951921450688566, 0.998047302865917, 0.9979297007628247, 0.9980625717620314, 0.998378361980241, 0.9975783292477035, 0.9980969649399992, 0.9978271991362235, 0.9979706579627173], [0.997723944694483, 0.9976717932557062, 0.9979283182367938, 0.9979044934487292, 0.9978787138668564, 0.9978090755612372, 0.9980795897686455, 0.9978830357811582, 0.9978341649867523, 0.9978573890051081], [0.9979083188011675, 0.9971158506788501, 0.9977732504857821, 0.9976214575531412, 0.9977090529028667, 0.9977815698725234, 0.9978868803897982, 0.9980511456785648, 0.9976944005620709, 0.9977959916656446], [0.9979177373002986, 0.9978004131318091, 0.997829350371225, 0.99780183337049, 0.9978994246007876, 0.9976844457355755, 0.9978511309201912, 0.9978247398255468, 0.9977256142072066, 0.9977870877840281], [0.9977234628694933, 0.9976852127966278, 0.9976071695270259, 0.9977859850373401, 0.9976132566922483, 0.9976079271348435, 0.997578230648432, 0.9976254659027803, 0.9976079355283997, 0.9976454739808525], [0.997265259479572, 0.9975247556973685, 0.9973786511663026, 0.9961660989980509, 0.9974865218552995, 0.9972506763740759, 0.9975673652535634, 0.9976273304247582, 0.9975941120548334, 0.9975653934212548], [0.9969585094263553, 0.997109006550793, 0.9969670467901287, 0.9969727936979911, 0.996913632325234, 0.9970156140254414, 0.9973842281908838, 0.9969572559224866, 0.9971345207674233, 0.9932651382409295], [0.9899713517883306, 0.9884157279987293, 0.9944292790671685, 0.9953493028356852, 0.995238434769166, 0.9955427054635841, 0.9946775860106445, 0.9959215116703484, 0.9954410623106186, 0.995332232643651], [0.9091400319245768, 0.9382383944759967, 0.9716975989003879, 0.6305571752981689, 0.9239030213291858, 0.938537688800508, 0.9667833708402461, 0.94836777578012, 0.9140916693584875, 0.9186176141782751]], 'MSE': [[1.044130764499906, 2.4139080359128964, 1.174428094440781, 1.1566256157501953, 1.2086740245842329, 1.0743758985283698, 1.1968751870910701, 1.0711357758414488, 1.1079168527324941, 1.1240827365415809], [1.173765399856709, 1.1959007007153171, 1.224971734594779, 1.232630411841106, 1.1485666675968322, 1.2014701188076251, 1.1855453745811888, 1.1614322408030453, 1.2017315515847555, 1.1958011354092706], [1.2769991864744963, 1.7995554215940275, 1.1805496214511799, 1.2587603241528436, 1.2672897357533193, 1.1779994486717276, 1.219228000984155, 1.1765313124260157, 1.2306338733957012, 1.2116574978377836], [1.2808309070364796, 1.2569301076499761, 1.260573621936822, 1.2527015001756732, 1.2632051787402248, 1.2968694875345366, 1.1923630725527183, 1.2616223819897514, 1.2557209546512635, 1.2321210808332639], [1.267550124381795, 1.3505814547898933, 1.3889670863756638, 1.3413898710816359, 1.343374918637654, 1.3321739978233957, 1.3636928344478072, 1.2915660732473415, 1.3694959327698075, 1.3156670856004009], [1.4753610142200577, 1.4143945088000158, 1.5437207196644922, 2.1326412026451087, 1.4441471316678816, 1.4466596195057999, 1.4283718400593597, 1.4732136761022112, 1.4428493946266663, 1.4071468300730523], [1.7632238986108744, 1.6905153642210393, 1.7693326322920491, 1.7426467708059412, 1.7771316614806749, 1.7365641247512897, 1.5751189955367642, 1.712675402288736, 1.6437985708622473, 3.8051370686753114], [5.5581304664405806, 6.4771216251795556, 3.2415948718074321, 2.7215311301175076, 2.6222991473624346, 2.5604231415857353, 3.0733280716712916, 2.3804113323328675, 2.6784281225778197, 2.592153036828059], [51.951819511913257, 36.265800647062591, 16.62730305107635, 206.18532128377154, 43.73050111129875, 35.356542003298834, 19.045634587537538, 28.968309668740257, 49.227672608650025, 47.281594631408829]], 'Rp': [[0.99909250017920925, 0.99761844083589213, 0.99903945323235999, 0.9989778896652548, 0.99903914439579089, 0.99919142448208687, 0.9988040895207041, 0.99905604640044021, 0.99892144781606063, 0.99898622117657587], [0.99886484386624896, 0.99883562421300864, 0.99896469790006648, 0.99895181783185061, 0.99894116021977508, 0.99890471566946004, 0.99904011194899633, 0.99894612350718592, 0.9989169762501855, 0.99892897390532198], [0.99895424519569498, 0.99855773549452265, 0.99888914758589042, 0.99881120658850497, 0.99885640031361655, 0.99889032864094907, 0.99894536004257384, 0.99902516695731458, 0.99884687435442043, 0.99889911796498354], [0.99895888553845535, 0.99889979633693793, 0.99891469941796951, 0.99890165269091669, 0.99895216655777896, 0.99884186623078364, 0.9989252997587762, 0.99891318105401083, 0.99886504782766938, 0.99889412271436839], [0.9988627669968384, 0.99884447164728374, 0.99880587095634854, 0.99889468571464179, 0.99880593674998785, 0.99880400616233955, 0.99878897123152843, 0.99881295002839798, 0.99880472744854498, 0.99882416422016929], [0.99863285670978785, 0.99876172284556386, 0.99869120999842176, 0.99808198155755901, 0.9987449011022056, 0.99862539017529961, 0.99878376010502345, 0.99881334791813337, 0.99879671546335402, 0.99878226577274787], [0.99848189520699726, 0.99855443832412261, 0.99848307278147952, 0.99848656793117407, 0.99845766495764365, 0.99851235748913691, 0.99869520612017348, 0.99847913824422296, 0.9985682153194877, 0.99664066589941136], [0.995001457350564, 0.99433541390483104, 0.99721523562188163, 0.9976906456123551, 0.99761676089746587, 0.99777277941086762, 0.99734725597516205, 0.99796029073810621, 0.99773563153387479, 0.99766568802104738], [0.95707697063246222, 0.9700767467356135, 0.98587621212658116, 0.86539133938137569, 0.96122616458200916, 0.97077634374349631, 0.9835812601299353, 0.97555456397485762, 0.95823767716712493, 0.95859963448773389]]} 
gibbs_average_performances = {'R^2': [0.99772687580307196, 0.99785705186054707, 0.99773379185904099, 0.99781217772471575, 0.99764801201180442, 0.99734261647250799, 0.99666777459376665, 0.99403191945579261, 0.90599343408859545], 'MSE': [1.2572152985922973, 1.1921815335790629, 1.279920442274125, 1.2552938293100708, 1.3364459379155396, 1.5208505937364645, 1.9216144489524929, 3.3905420945903288, 53.464049910475794], 'Rp': [0.99887266577043743, 0.9989295045312101, 0.9988675583138471, 0.99890667181276671, 0.99882485511560815, 0.99867141516480973, 0.99833592222738488, 0.99703411590661573, 0.95863969129611915]}

# ICM NMF
icm_all_performances = {'R^2': [[0.9980693518798559, 0.9980650295036878, 0.9980307053978758, 0.9978811363283607, 0.9979963144809417, 0.998311955167851, 0.9983095751437272, 0.9980585146711096, 0.997564185371215, 0.9981865289420598], [0.9979425900963221, 0.9980330642566773, 0.9976667383197281, 0.9976821363531407, 0.9977019772654402, 0.9977973345568008, 0.9979649865096252, 0.997795223024907, 0.9975414467557729, 0.9981312480797617], [0.9974388398868174, 0.9979237023984291, 0.9978341239972611, 0.997815734097659, 0.997766453369638, 0.997906882397487, 0.9977391951113755, 0.9975269248654052, 0.9976844457923485, 0.997763063400752], [0.9976148582593359, 0.9977980321662996, 0.9978438378581211, 0.9977759619793886, 0.9974380894797196, 0.9976389130346645, 0.9978634852468675, 0.997437542686439, 0.9978099478202074, 0.997576095517613], [0.9975505804259096, 0.9971115872043165, 0.9972488977559254, 0.9976113859219101, 0.9974879889383337, 0.9975781069268959, 0.9976552577963839, 0.9976601116579806, 0.9975799086994723, 0.9974815705152273], [0.9973031705495954, 0.9971820328424386, 0.9971814848452629, 0.9555082537498438, 0.9972636357061917, 0.9975404603626555, 0.997151884783449, 0.9970291624345302, 0.9969229418351611, 0.9970265663988632], [0.9967277456897006, 0.9953522605017211, 0.9963692482015742, 0.9963364063357437, 0.9966055290745393, 0.9965316234203774, 0.996063424492834, 0.996652563565741, 0.9971103276289504, 0.9964471763456089], [0.9850227967657157, 0.9301906170740711, 0.952932281991087, 0.9875004001732487, 0.9932041954711699, 0.9908974989912886, 0.9836406084136251, 0.9918345036878309, 0.9927676223431604, 0.9720486839579983], [0.7914915043334793, 0.7708958782921185, 0.7139597249429701, 0.6104540918932067, 0.6020965581127673, 0.4450395935311162, 0.7473136642328895, 0.7241130559005058, 0.789016701051569, 0.7249638774439595]], 'MSE': [[1.2315042720732527, 1.261125150824203, 1.3819906332123801, 1.2346683358917998, 1.1021822094339695, 1.1502883602280003, 1.1969994548243994, 1.1953559930597719, 1.1284184942220348, 1.2430954014227995], [1.209762858914363, 1.219247594101494, 1.2463659900726971, 1.2646013987045428, 1.3338582080927799, 1.1994887175256945, 1.2039907298446721, 1.3515851258339224, 1.3371449688780492, 1.2294195185386474], [1.3770487357344334, 1.2973893675753165, 1.2253801194044063, 1.2505158367571096, 1.3010733324241597, 1.2067011218116022, 1.3122830892984403, 1.2968990623576664, 1.2361603981168758, 1.2789435075297211], [1.3963670709111482, 1.272228022394106, 1.2734353250430086, 1.315003202429911, 1.3667122666837641, 1.3875699597687139, 1.3255286700836595, 1.3909760118961307, 1.3419326589572034, 1.3274677747305459], [1.3553040251160748, 1.6407879525505491, 1.6147294799120784, 1.4719098069073107, 1.4919913753478513, 1.3785331131754499, 1.3755973785177491, 1.4022338367031746, 1.4103322663161195, 1.354646818936551], [1.5160299879244041, 1.6044333589917796, 1.6210767149900773, 25.641986270964686, 1.6228669497187258, 1.4552909685429163, 1.6393571896926609, 1.6968781422300023, 1.7248229804311097, 1.6918369255701029], [1.8530600961548938, 2.669369938535795, 1.9941796352383685, 2.07732058682552, 1.9584007260031626, 2.0322491069987283, 2.120935135110535, 1.8827431898588964, 1.7050080495219548, 2.0801394829930824], [8.8821279675242444, 41.181303541641626, 27.506682279365954, 7.2072204864225533, 3.9053433818577656, 5.3688420811174398, 9.3474553569306007, 4.5553158231321165, 4.203886777938993, 15.797800575880402], [121.95986549160024, 132.43987194514142, 160.90566480998714, 217.97140795935948, 232.19558416181943, 312.42305397899952, 144.96056527588809, 159.17939146265488, 122.00296214083629, 157.33899110469352]], 'Rp': [[0.99904771133745562, 0.9990330897315548, 0.99901619936287378, 0.99894517762445478, 0.99900204959320404, 0.9991564094819666, 0.99915594695901644, 0.99903050674642757, 0.99878490195457015, 0.99909436485766689], [0.99897109558964703, 0.99901991071594332, 0.99883659220413568, 0.99884110868157916, 0.99885118393002181, 0.99890080263102021, 0.99898394296746051, 0.99889928589417332, 0.99877163379818801, 0.99907175040502694], [0.99871865926064873, 0.99896399816445247, 0.99891649020392725, 0.99891166457613445, 0.99888268342600228, 0.99895400237982024, 0.99887040758985834, 0.99876315446667663, 0.99884438945684695, 0.99888252630905228], [0.9988122786382545, 0.99890133199748277, 0.9989214553685658, 0.99888875947386391, 0.99871824770575834, 0.99882199359444546, 0.99893334711562787, 0.99872325172976328, 0.99890550271131695, 0.9987874199749488], [0.9987750169157612, 0.99855636735685516, 0.99862847105540486, 0.99880540516909533, 0.99874450563017902, 0.99879153276201504, 0.99882720424192539, 0.99883172217160587, 0.99878978436845911, 0.9987421038829174], [0.99865657600569813, 0.9985919777946406, 0.99859034623921361, 0.97877302433655589, 0.99863197023539563, 0.99876956069388056, 0.99858004293706037, 0.99851481125224617, 0.99846109508859837, 0.99851792514500559], [0.99836494577066337, 0.99768838253125014, 0.9981866434615333, 0.99817074502069691, 0.99830195181919645, 0.99826495207290356, 0.99803768992769926, 0.99832919168078627, 0.99856298397936305, 0.99822444060688476], [0.99248917478431042, 0.96811453864648245, 0.97761568253494746, 0.9937945331116752, 0.99660277488745697, 0.99561841262253337, 0.99184683578867405, 0.99592574136796574, 0.99638549750570415, 0.98617748094537272], [0.90344731436060188, 0.89124214950955516, 0.87295697122080906, 0.83278066588639166, 0.85274689104659729, 0.784637542204076, 0.88030264529350455, 0.88598160030870354, 0.9093981390867466, 0.87883087395887449]]} 
icm_average_performances = {'R^2': [0.99804732968866861, 0.9978256745218177, 0.99773993653171744, 0.99767967640486543, 0.99749653958423556, 0.99301095935079908, 0.99641963052567895, 0.97800392088691956, 0.69193446497345812], 'MSE': [1.2125628305192611, 1.2595465110506863, 1.2782394571009732, 1.3397220962898193, 1.449606605348291, 4.0214579489056463, 2.0373405947240935, 12.795597827181167, 176.13773583309799], 'Rp': [0.99902663576491901, 0.99891473068171965, 0.99887079758334196, 0.99884135883100278, 0.99874921135542183, 0.99660873297282948, 0.99821319268709774, 0.98945706721951221, 0.86923247928758607]}

# Non-probabilistic NMF
np_all_performances = {'R^2': [[0.9965794806937358, 0.9971453500724721, 0.9981428465668064, 0.9981901237271512, 0.9975263114959018, 0.9979196835407667, 0.9981919809098552, 0.9975520075135906, 0.9978290401185664, 0.9976472136708714], [0.9980277647909558, 0.9978594746116717, 0.9976881072129298, 0.9956588423674528, 0.9982163595432593, 0.9947044224462538, 0.997230692444883, 0.9977358742909597, 0.9976094750240804, 0.9976299660239127], [0.997435627039684, 0.9963790076192582, 0.995986831736009, 0.9976485774548275, 0.997711118153137, 0.9962214640673074, 0.9975133074980972, 0.9977640689040296, 0.997790513780816, 0.9977358865362613], [0.9973169152741639, 0.9966548397613676, 0.9977216853731572, 0.9971258704888211, 0.9978141626794429, 0.9950802697330126, 0.9975288757168652, 0.9958626574592142, 0.9952652196313718, 0.9955225124942837], [0.9954311068567063, 0.9972383474539191, 0.9957577445894775, 0.996014949882689, 0.9974186490858182, 0.9975072947426273, 0.9952919684838495, 0.9954708015298185, 0.9957341683820558, 0.996261371634472], [0.9971010640898383, 0.9965281084614893, 0.9972873885868944, 0.9974548689974645, 0.9974256210850087, 0.9972196346120844, 0.9952139318810681, 0.9949284037159659, 0.994734148488508, 0.9974208078241388], [0.9962304348451211, 0.9927435984625665, 0.9929980265198465, 0.9959329248048969, 0.9840714222063914, 0.9962077793367459, 0.9966097132971062, 0.9964674302890528, 0.9966948726258622, 0.9960575529704035], [0.9915136914287299, 0.9787533854121393, 0.9885522438694284, 0.9679761126313882, 0.9643370084340268, 0.9509440177033566, 0.8312032242277436, 0.9511607101123961, 0.9935705327048391, 0.8860427000876773], [0.3092094978338299, 0.7490026662039752, 0.7616442348179249, 0.7863265985048895, 0.7997922448487483, 0.3851103099319111, 0.7494283276145897, 0.838294921299355, 0.6741379025616767, 0.6986459241100779]], 'MSE': [[2.213980169469806, 1.2825469681851047, 1.1116541199191037, 1.2820060167466192, 1.5546303386886047, 1.1175911910169924, 1.18418508137542, 1.2731326331578265, 1.1529609416753248, 1.2546407531574433], [1.1972743224741724, 1.2164646064407061, 1.3309489101512886, 2.4820349955289225, 1.1990382940546791, 2.95703042503823, 1.7280559203750403, 1.2428185771380105, 1.2777489440682692, 1.3855801117966298], [1.4562505946930315, 2.1590482064617582, 2.4510143914221953, 1.3026165311517222, 1.3211222661998476, 2.1584213250118967, 1.5260009426146264, 1.238210578551475, 1.2786540043242465, 1.3108829000337536], [1.4362328672155271, 2.0291161469882444, 1.3217316502855128, 1.7721105111185309, 1.2792183238296244, 2.6111697433718568, 1.483726103796136, 2.3993888058905135, 2.6537880870084107, 2.5350190422475554], [2.6480961925299038, 1.6458319522661948, 2.4734395907496913, 2.1317427813721928, 1.4196277244259645, 1.3593454012848867, 2.7539380482961442, 2.5960850873596102, 2.3941171533713623, 2.1363995217261706], [1.591850851929856, 2.0338866618298312, 1.5234623133903999, 1.5754144175939815, 1.4608734851849792, 1.5881689594183437, 2.646514368971606, 3.0263512769381884, 2.9493442858335275, 1.4901273135801147], [2.1370000968708891, 4.0873177720939893, 3.9846596821244762, 2.3412311572202231, 9.5329821098256193, 2.136176033752065, 1.9113298985808047, 1.9694854402080835, 1.8685281133933196, 2.1836511484631158], [5.0343848752108364, 12.209035967466773, 6.4627685249135265, 18.501997874476515, 20.587650840684837, 27.807976170243368, 97.765805360118804, 27.718234638131136, 3.6880641828695264, 67.058360226392608], [395.56634607380516, 144.9979832186205, 136.12300462465819, 122.92053505096801, 116.45347965904936, 347.01805242625471, 141.40733712004518, 92.834653475706006, 187.37205320413921, 174.5130029856135]], 'Rp': [[0.99829323616557908, 0.99857274016240971, 0.99908505240774892, 0.99909531898841786, 0.99876510543540054, 0.99896279945788069, 0.99909738431303274, 0.99877787817187691, 0.99892352589120081, 0.9988248041099923], [0.99901493366121275, 0.99893073870187943, 0.99884568055488065, 0.99783327863226312, 0.99910936742371326, 0.99735044625534619, 0.99861444589896309, 0.99887049150075014, 0.99880518023554965, 0.99881721650242072], [0.99872824262755222, 0.99819336577659623, 0.99799975167811761, 0.99882493915671278, 0.9988551127880041, 0.99810923122056283, 0.99875654397322777, 0.9988826153114696, 0.99889501068340925, 0.99887465045849655], [0.99865776670023731, 0.99832661740175732, 0.99886080340755168, 0.99856701547309312, 0.99890925791327312, 0.99753958937956799, 0.99876478644762434, 0.99793389089051221, 0.99763133818396743, 0.99775998789716847], [0.99771494832739083, 0.99861884177330718, 0.99788108655947816, 0.99800936426808673, 0.99871242496533774, 0.99875639779167147, 0.99765052691590228, 0.99773474614978874, 0.99786905684875471, 0.9981381891804284], [0.99855027572909372, 0.99826396076126966, 0.99864280115485227, 0.99872798743969671, 0.99871559393059717, 0.99860933125405094, 0.99761340770839546, 0.99746292569714246, 0.9973666082173509, 0.99871047801929325], [0.99812363168326368, 0.99637714890893958, 0.99653814813599439, 0.9979663575304244, 0.99203003414369162, 0.99810758038437042, 0.99830789923750707, 0.99823401413012747, 0.99834636817217359, 0.99802872233880058], [0.99577725979992249, 0.98945040929399475, 0.99425987840038699, 0.98391001349742058, 0.98248746837829026, 0.97625614912783165, 0.92007674903460279, 0.97542704034413907, 0.99678951814617289, 0.94432195832054411], [0.78221388848750018, 0.88529163413729561, 0.88193738409483702, 0.90000225298982051, 0.90377617685489409, 0.79242293058935076, 0.87446762244065157, 0.92678434707781943, 0.86352089417190003, 0.87214400483325694]]} 
np_average_performances = {'R^2': [0.99767240383097167, 0.99723609787563594, 0.99721864027894269, 0.99658930086117015, 0.99621264026414325, 0.99653139777424593, 0.99440137553579944, 0.95040536266117237, 0.67515926277269789], 'MSE': [1.3427328213392244, 1.6016995107065948, 1.6202221740464551, 1.9521501281751914, 2.1558623453382117, 1.9885993934670829, 3.2152361452532587, 28.683427866050796, 185.92064478388599], 'Rp': [0.99883978451035405, 0.99861917793669797, 0.99861194636741479, 0.9982951053694753, 0.99810855827801481, 0.99826633699117429, 0.99720599046652914, 0.9758756444343305, 0.86825611356773269]}



# Assemble the average performances and method names
methods = ['VB-NMTF','G-NMTF', 'ICM-NMTF', 'NP-NMTF']
avr_performances = [
    vb_average_performances,
    gibbs_average_performances,
    icm_average_performances,
    np_average_performances
]

for metric in metrics:
    plt.figure()
    #plt.title("Performances (%s) for different fractions of missing values" % metric)
    plt.xlabel("Fraction missing", fontsize=16)
    plt.ylabel(metric, fontsize=16)
    
    x = fractions_unknown
    for method, avr_performance in zip(methods,avr_performances):
        y = avr_performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', marker='o', label=method)
    plt.legend(loc=0)  
    
    if metric == 'MSE':
        plt.ylim(0,MSE_max)
    else:
        plt.ylim(0,1)