"""
Plot the performances of the many different NMTF algorithms in a single graph,
as we vary the fraction of missing values

We plot the average performance across all 10 attempts for different fractions:
[0.1, 0.2, ..., 0.9].

We use a dataset of I=100, J=80, K=10, with unit mean priors and zero mean unit
variance noise.

We have the following methods:
- VB NMTF
- Gibbs NMTF
- ICM NMTF
- Non-probabilistic NMTF

"""

import matplotlib.pyplot as plt, numpy
metrics = ['MSE']#['MSE','R^2','Rp']

MSE_max = 30

fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 

# VB NMF
vb_all_performances = {'R^2': [[0.9950277311670301, 0.9950362540064918, 0.9977338762826371, 0.9946418108005373, 0.9984314418887056, 0.9979171620315069, 0.9982375822670195, 0.9981472503628788, 0.9976181499418831, 0.9982023621563685], [0.994796648525581, 0.9977153753127386, 0.998095838501728, 0.9978227916289657, 0.9982815606110297, 0.9983027985302119, 0.9955787303766429, 0.9949469934228514, 0.9978972809253873, 0.9952479717554424], [0.9977480926165051, 0.9980685063734909, 0.9957328274572746, 0.9977347232024003, 0.9950283364083812, 0.9954314156259906, 0.9951030139929761, 0.9978582793458053, 0.9954916017454035, 0.9953709637017584], [0.9977319322135799, 0.997687088737984, 0.994946942179349, 0.9949536855384639, 0.9950621464173323, 0.9978791402297771, 0.9979310192347216, 0.9978046639030107, 0.9978505415336579, 0.995849608377376], [0.9977155944222503, 0.9952479671434111, 0.9689641168223063, 0.995260359919225, 0.995250983933575, 0.9744961487049554, 0.9953063281467225, 0.9950617811119985, 0.9707114581654543, 0.9732861326889626], [0.9735061002342034, 0.9728466153373351, 0.9947599190009041, 0.9948960324500463, 0.9949461228865316, 0.994865632554931, 0.9948504782894455, 0.974797101037195, 0.9717573278727932, 0.9696867239821485], [0.9663439526247147, 0.9685369361042374, 0.9712678819552871, 0.9940464888515127, 0.9699058477359624, 0.9712432932901175, 0.9687191998424838, 0.9713571770401356, 0.9944948321180072, 0.9709790071625185], [0.9680331784831949, 0.9638252691829845, 0.9567874670120828, 0.9603646899881294, 0.9666936166921205, 0.9460833406184549, 0.9554628031118125, 0.9649361961029994, 0.9577191791733791, 0.9616833474402544], [0.8978838535283761, 0.9133593258182544, 0.9032214670066678, 0.9081531157581764, 0.9318886911810746, 0.9052656310769353, 0.9083605976522274, 0.9083860602114315, 0.9019612406798678, 0.8508822932819876]], 'MSE': [[2.5690679020125105, 2.6230751690901486, 1.1875172610544722, 2.5589152559511326, 1.1180264569052294, 1.1806693736737592, 1.1501341539616372, 1.1304715320116827, 1.1606818630980338, 1.0423986988231237], [2.7028553044362815, 1.2952389738583379, 1.1922107904845272, 1.1928545946117648, 1.2338003167777349, 1.1162418385839967, 2.6283360550034076, 2.8090357462404563, 1.1929282632957234, 2.4819678904821041], [1.206773931576069, 1.2576820539879119, 2.4560848649633007, 1.2431073549114398, 2.6836572952414479, 2.6421439967270337, 2.8157250241168597, 1.2085902656108276, 2.4297302861812717, 2.7345722356687618], [1.1750966372504097, 1.326909891614934, 2.6671327349641132, 2.8137891351688298, 2.7504832018970609, 1.267010892794691, 1.2050482263152056, 1.2547299207237541, 1.2555319752255851, 2.45469211521015], [1.3125799670217229, 2.9280965338523437, 17.871096625690203, 2.7109506834144077, 2.6740406632748051, 14.088530610418518, 2.6397519531013556, 2.8787168876784084, 15.889736336652422, 15.525039507066241], [15.935804011504203, 15.397322216717646, 3.0700822539145065, 3.0354431163934068, 2.8612933732674413, 3.1151683931513632, 2.9274513615773663, 14.295230867400248, 15.725075146373452, 16.571422575544709], [19.267423426482345, 17.311021683613312, 16.452431105066676, 3.4970347264040083, 16.982186660187228, 16.65709177072673, 17.941515232117851, 16.24443402638974, 3.264741151910485, 16.457635760568635], [18.38319881379693, 21.672455898217198, 25.241619174400661, 22.191529441855756, 19.394644897563001, 30.274956985107384, 25.210283046297203, 19.997192203359688, 23.967108976951032, 22.521792474824839], [57.999642364109533, 49.628370346413817, 56.184034523132212, 52.810738994732148, 38.67731867855111, 53.485198888748151, 52.351827681455454, 52.375659920923709, 55.638334994140322, 83.975284945245662]], 'Rp': [[0.99761749026084123, 0.99752261197260328, 0.99886918284591508, 0.99731846172815442, 0.99921631217022377, 0.99895817837649048, 0.9991290606699833, 0.99907838488622802, 0.99880910010583546, 0.99910190856425674], [0.99740076464038108, 0.99885777618563687, 0.99904945305637205, 0.9989115074913697, 0.99914133141295558, 0.99915189712806773, 0.99778776511168032, 0.99748310011231534, 0.99895203564433788, 0.99762370046939242], [0.99887362711069705, 0.99903791776253348, 0.99786523089933277, 0.99886851169004043, 0.99751301048096686, 0.9977163912005319, 0.99755257373710504, 0.99892869048730681, 0.997743390561459, 0.99768380336783768], [0.99886775014717044, 0.99884537089121361, 0.99748405742546542, 0.99747618721438225, 0.997531595757987, 0.99894240887195651, 0.99896561848911569, 0.99890260985772705, 0.99892548487710497, 0.99793131046923778], [0.99885992882656371, 0.99762822599135359, 0.98440474644165676, 0.99763552999821836, 0.99762266628386953, 0.98722742295368149, 0.99765154026069192, 0.99754002649692564, 0.98535720622923084, 0.98656132967826082], [0.98666423349660159, 0.98636925524194763, 0.99737819562566143, 0.99744602635934176, 0.99746994031682679, 0.9974463063612653, 0.99742526574047186, 0.98732219723463632, 0.98578189587658605, 0.98474359185872384], [0.9831967783043416, 0.98414690970813468, 0.98570406525321341, 0.99701903782135781, 0.98486074552004454, 0.98553177985683516, 0.98425224576241144, 0.9857552545952557, 0.99726941096560517, 0.98545250822422581], [0.9838949235668043, 0.98175632611174024, 0.97820289675532945, 0.98029398758884145, 0.98323405786295071, 0.9741814795324456, 0.9780612374039469, 0.98232229041777752, 0.97901377075938256, 0.98067533893216707], [0.94957860676727501, 0.9570512150575875, 0.95055391393911348, 0.95374057059794737, 0.96863208622115105, 0.95386511302885924, 0.95359173477112102, 0.95337309590377739, 0.95201684470361014, 0.93503054821936826]]} 
vb_average_performances = {'R^2': [0.9970993620905059, 0.9968685989590579, 0.9963567760469985, 0.9967696768365254, 0.986130087105886, 0.9836912053645535, 0.9746894616724978, 0.9601589087805413, 0.9029362276194999], 'MSE': [1.572095766658173, 1.7845469773774334, 2.0678067308984924, 1.8170424731164734, 7.8518539768170426, 9.2934293315844343, 14.407551554346702, 22.885478191237368, 55.312641133745217], 'Rp': [0.99856206915805301, 0.99843593312525081, 0.99817831472978114, 0.99838723940013607, 0.99304886231604539, 0.99180469081120626, 0.98731887360114268, 0.98016363089313852, 0.9527433729209811]}

# Gibbs NMF
gibbs_all_performances = {'R^2': [[0.9980265537770171, 0.9980148846868151, 0.9979423798713575, 0.9979373981717664, 0.9982096738709807, 0.9978774239249413, 0.9977133599497527, 0.9977521642156745, 0.9980558651387604, 0.9983298715163728], [0.9977483682792698, 0.9976555013899399, 0.9980322320380159, 0.9981103180464137, 0.9980197107436324, 0.9973853555522758, 0.9977645728204921, 0.9983965636152167, 0.9979060281735868, 0.998036765235189], [0.9978276360078263, 0.9976333911726203, 0.9979730339006768, 0.9975854211943138, 0.9979282747815224, 0.9981180717149507, 0.9980300385199864, 0.9978229229717182, 0.997975959446187, 0.997839596335278], [0.9979251759407977, 0.9978809560634602, 0.9978361389981409, 0.9977949529914594, 0.9979445703908161, 0.9976585316548542, 0.997838425619466, 0.9978969870383029, 0.9978578805673619, 0.9980273357440586], [0.9978382046344352, 0.9977568477355244, 0.9976596486344239, 0.9977514281862052, 0.9975346605507922, 0.997639622687077, 0.9977375901718548, 0.9975977668490495, 0.9974872188278787, 0.9976117398822806], [0.9974738769995448, 0.9974864151391206, 0.9974510340021282, 0.9973845984234755, 0.9975726611036115, 0.9973986175514632, 0.997203172762798, 0.9975699048386895, 0.9975487227231692, 0.9976515151240554], [0.9970349243842102, 0.9970611328023047, 0.9970065037181833, 0.9969446914859835, 0.9832214485762876, 0.9969582612108989, 0.9967332128857133, 0.9970011574759813, 0.9970176027097376, 0.997053693316746], [0.9857597330418775, 0.9954518068345874, 0.9954132720355684, 0.9957322195055438, 0.9954949985661633, 0.9957682655503756, 0.9954780616220206, 0.9956293741291482, 0.9940018713989031, 0.9932218730979444], [0.9770071892765756, 0.9148787376226705, 0.9537886212222555, 0.9723788657818548, 0.9640066607462843, 0.9349768213114001, 0.978819132739358, 0.9573119797070576, 0.9793353421809781, 0.9592845395399638]], 'MSE': [[1.1524378666513504, 1.18927023184235, 1.1313268051893266, 1.1573648965093317, 1.3039252295712016, 1.1177815148859978, 1.2353098392602744, 1.2086043403252438, 1.0617161578890018, 1.0707315082842961], [1.2686868930941149, 1.2714358519884974, 1.2082195366876793, 1.2079142521175448, 1.2336724546248976, 1.1968630571551704, 1.3109965753012667, 1.1193874329456672, 1.1269428520454894, 1.1364905946565353], [1.2282521107762503, 1.2451939541913188, 1.2101984056528943, 1.229305514753694, 1.1688543351974383, 1.1984996963293773, 1.1707526144143898, 1.2670125830519754, 1.2116939905747837, 1.2527507018590658], [1.2420887009745973, 1.2723115182581266, 1.289580821594827, 1.2827917427314079, 1.272319149727805, 1.2319986164934158, 1.2319316780483456, 1.2595579967557722, 1.2596445738096771, 1.2359831600586733], [1.2977203579650238, 1.3055573318363849, 1.3363550372569668, 1.338665657177029, 1.3295718304331339, 1.3607514052004632, 1.3396787380932444, 1.3178314209722926, 1.3328354786594898, 1.3153882433503055], [1.4526450864346947, 1.4647320881828383, 1.4883283575162773, 1.4638165825409077, 1.4357788557705791, 1.4710085415663618, 1.4650609659729221, 1.4956147259092536, 1.5032578708076763, 1.3977807923960186], [1.7740954283009094, 1.7329207266692876, 1.7220832251611, 1.643965769231807, 9.6534128380510484, 1.7412834520216971, 1.933283796962397, 1.6198509744130531, 1.6683699208923892, 1.674626162728118], [8.1191787535525854, 2.5354030649001391, 2.6184268305486529, 2.4442387143471418, 2.5205194333692402, 2.4555759320360457, 2.6370491852353597, 2.5274586518524105, 3.3914616441386602, 3.9711234464481286], [12.999857016211829, 47.177759853738195, 26.694809157679362, 15.602478919141165, 20.615554175324821, 37.524487630008743, 12.031029996398489, 24.882439472246986, 11.852775710279857, 23.733190667372575]], 'Rp': [[0.99901680410628968, 0.99900824597575166, 0.99897404252340416, 0.99896869533857924, 0.99910831931159838, 0.99894379491293706, 0.99886740485573966, 0.99887818528300765, 0.99903071285124867, 0.99916600483199114], [0.99887398648674497, 0.99882738299274376, 0.99901931908812192, 0.99905564261893121, 0.99900948800666045, 0.99869222001418301, 0.99888443722092701, 0.99919830192410508, 0.99895930375940489, 0.99901876243346399], [0.99891520399399814, 0.99881820481371764, 0.99898676244419227, 0.9987931024239578, 0.99896483051972618, 0.99905865135929883, 0.99901464447284838, 0.99891138627182419, 0.99899203930524028, 0.998922733245445], [0.99896390369982102, 0.99894234828156292, 0.99891807066052141, 0.99889715121069877, 0.99897223642930744, 0.99883123643027816, 0.99892100920354998, 0.99894810209230378, 0.99893074016810657, 0.99901319660941335], [0.9989193813573185, 0.99887823805101583, 0.99882961388145863, 0.9988759518844903, 0.99876942641220423, 0.99882007179128696, 0.99886907345448905, 0.99879877070269885, 0.99874371145877516, 0.99880665135639712], [0.99873995820150296, 0.99874320501910263, 0.9987257000935037, 0.99869167757184907, 0.99878631338077895, 0.998700078850285, 0.99860066368461398, 0.99878740269635591, 0.99877448993037188, 0.99882508512692392], [0.99851773726275306, 0.99853061580821401, 0.99850431297236364, 0.99847502916745234, 0.99191155215720883, 0.99848062557894024, 0.99836637388761995, 0.99850058753499471, 0.99850855867517185, 0.99852666341704699], [0.99293876560780359, 0.99773921632219975, 0.99770783726198931, 0.99788524453170591, 0.99774519224547586, 0.99788570838860102, 0.99773744884763171, 0.9978147976809465, 0.99700114534353057, 0.99662716422468223], [0.98865481922677867, 0.95835477076345377, 0.97803061322443652, 0.9861381561361704, 0.9818678769876733, 0.96923459129913947, 0.989666942137992, 0.97904407215314204, 0.98971155149249013, 0.97973171560508532]]} 
gibbs_average_performances = {'R^2': [0.9979859575123438, 0.9979055415894033, 0.997873434604508, 0.9978660955008717, 0.9976614728159523, 0.9974740518668055, 0.9956032628566047, 0.9941951475782131, 0.9591787890128398], 'MSE': [1.1628468390408375, 1.2080609500616863, 1.2182513906801189, 1.2578207958452645, 1.3274355500944335, 1.4638023867097529, 2.5163892294431807, 3.3220435656428364, 23.311438259840202], 'Rp': [0.99899622099905483, 0.99895388445452871, 0.99893775588502487, 0.99893379947855632, 0.99883108903501339, 0.998737457455529, 0.9978322056461767, 0.99710825204545661, 0.98004351090263619]}

# ICM NMF
icm_all_performances = {'R^2': [[0.9975927090292699, 0.9980081023219172, 0.9978155521077262, 0.9975554561095054, 0.997923878035404, 0.9982099616576611, 0.9981625860413992, 0.9978359736733243, 0.9978779504510271, 0.997515342709776], [0.9975890536153215, 0.9980292910066693, 0.9979194412541915, 0.9979658918924728, 0.9975677425995196, 0.9980789962725235, 0.9978807816742185, 0.9979738215496476, 0.9977169179356461, 0.9979390527530128], [0.9977695576055731, 0.9977719145111632, 0.9977470654043835, 0.9975949936294892, 0.9978477764618622, 0.9974169395818809, 0.997792227822902, 0.9978193213459388, 0.9975648828625464, 0.9975486588574607], [0.9976570706503591, 0.997912315499696, 0.9975888360031283, 0.9975517834065201, 0.997401303631934, 0.9976416958006299, 0.9975701396700851, 0.9977735347994222, 0.9977381352638842, 0.9978347279701963], [0.9972048400356697, 0.9974121335180816, 0.9972725006709184, 0.9973945651110651, 0.9975860214597151, 0.9977031023255696, 0.9973354940256396, 0.9973366323745044, 0.9975166443424057, 0.9973194422122789], [0.9968876942549296, 0.9974666638945257, 0.9971232162590854, 0.9965339728630452, 0.9975274512294184, 0.9970835492426965, 0.9968105183626977, 0.9973085027696141, 0.9970350876802735, 0.9971047649757829], [0.9956004866700275, 0.9960425084997317, 0.9956908333301903, 0.9963534897720362, 0.9962563685498766, 0.996272429736938, 0.9963548678337069, 0.9958440798191359, 0.9957456641450465, 0.9958371822889462], [0.966490466863117, 0.9504011247182779, 0.9876873238870871, 0.9837743100507569, 0.9934731765762597, 0.9628010730795674, 0.9929675264889107, 0.9852611319618546, 0.980928068556346, 0.9846092579536968], [0.7448940841360358, 0.5644707788072548, 0.7317341967977111, 0.6268865264832666, 0.6904933275719349, 0.6529445005908574, 0.5883958546834347, 0.5221206128238185, 0.8335961861162272, 0.721881132667106]], 'MSE': [[1.2359111050754783, 1.3042928410580119, 1.2376394595262963, 1.2275988732827634, 1.2382569585089236, 1.1418971298061806, 1.1441518803914916, 1.2223920892944424, 1.2247789351682155, 1.2417987434632936], [1.2792307137209402, 1.2095820439287437, 1.204666514137299, 1.2176876197524185, 1.2450080035692148, 1.2369182353181538, 1.2530229409862728, 1.1919084524073353, 1.2828978056725004, 1.2545687977643687], [1.306426127698413, 1.2906457456653304, 1.3398826196253992, 1.3881057063319009, 1.2359863502075081, 1.3861514029887203, 1.2824578439380021, 1.368772494293425, 1.2942788237192839, 1.2678432597883094], [1.3495310437055388, 1.3641408699751489, 1.3558539963324807, 1.37733755299835, 1.3842753912555095, 1.3138440184813585, 1.4012705880437191, 1.2997572216472284, 1.3232244381774516, 1.3412297465782208], [1.4845439502286777, 1.4236733167015867, 1.4829075685316131, 1.5204074140569728, 1.4671178593650924, 1.296597105766925, 1.4165389674196776, 1.5220963946036925, 1.4511389025847241, 1.5223750280398956], [1.7278422464010317, 1.4371317131299706, 1.664199220301334, 1.8513490228163638, 1.4211713429603694, 1.6371637612297056, 1.7683467037268072, 1.5486671570896307, 1.7350633312338388, 1.6605389189725468], [2.6195785679210499, 2.3095470903110709, 2.4722099129359854, 2.1205864798805969, 2.1261213726651982, 2.1416350443412218, 2.1391932810654732, 2.3567048373783179, 2.4427368406574317, 2.3864977291757903], [19.054484310140925, 28.26033451828971, 7.1455382084831127, 9.5589530429614076, 3.744672733276559, 22.104946580343103, 3.930619863957872, 8.4495494068552048, 11.058583546825346, 8.8319755926652324], [144.22416058491476, 249.60357823247341, 153.54572226357712, 211.09141802208796, 176.71761117002131, 194.69471829847672, 237.88233262720109, 275.26569225321771, 95.593068425483409, 162.0412584829115]], 'Rp': [[0.99880420951544502, 0.99900395021136434, 0.99890857558075508, 0.99878035694496503, 0.99896500446856951, 0.99910731663444752, 0.99908550333940471, 0.9989248480995444, 0.99893876976564466, 0.99876195708329107], [0.99879681787297547, 0.99901489703340884, 0.99895955595351549, 0.99898584690408676, 0.99878738899022479, 0.99904044836434747, 0.99894016179002976, 0.99898821843986496, 0.99885993625712199, 0.99897197416089323], [0.99888436491207322, 0.99888592938366239, 0.99887397749315432, 0.9987985413547712, 0.99892389506668577, 0.99870798064138, 0.99889670828874466, 0.99890921170628233, 0.99878353194075076, 0.99877442025883056], [0.99882953400638341, 0.99895874015184949, 0.99879652488340387, 0.99877596405665137, 0.99869999080131067, 0.99882300349094955, 0.99878850333901692, 0.99888736849994753, 0.99887119732067753, 0.99891742914772053], [0.99860239521475547, 0.99870576989184867, 0.99863740745075846, 0.99869652065113557, 0.99880231392030572, 0.99885117938926438, 0.99867060989233092, 0.99867208619182257, 0.99875800884615606, 0.99865894212951556], [0.99844309014561028, 0.99873292732912911, 0.99856256752744232, 0.99826775109421695, 0.99876308359431631, 0.99854175878031926, 0.99840826616033396, 0.99865428180438387, 0.99852227404052185, 0.99855668698014199], [0.99780564121926174, 0.99802260055713676, 0.99786671812837191, 0.99819140855105448, 0.99813263124688767, 0.99813520389691202, 0.99817671233486327, 0.99793440286027668, 0.99787319646144834, 0.99791773308442666], [0.98362796692557153, 0.97694437268254153, 0.993825075948362, 0.991854258729025, 0.99673194445485813, 0.98223469976977984, 0.99649303700878877, 0.99265967783514075, 0.99053006207596628, 0.99229389145788727], [0.89031297236990137, 0.83497912445121836, 0.87060834703560308, 0.83604847675271821, 0.87662483639964928, 0.85831295806558006, 0.83403806731021446, 0.81720594968054239, 0.92663402534958672, 0.88144323801393565]]} 
icm_average_performances = {'R^2': [0.9978497512137011, 0.9978660990553223, 0.9976873338083202, 0.9976669542695855, 0.9974081376075847, 0.9970881421532068, 0.9959997910645635, 0.9788393460135871, 0.6677417200677647], 'MSE': [1.2218718015575099, 1.2375491127257248, 1.3160550374256292, 1.3510464867195005, 1.4587396507298858, 1.64514734178616, 2.3114811156332133, 12.213965780379848, 190.06595603603648], 'Rp': [0.99892804916434308, 0.99893452457664689, 0.99884385610463355, 0.99883482556979108, 0.9987055233577895, 0.99854526874564153, 0.99800562483406396, 0.98971949868879217, 0.86262079954289494]}

# Non-probabilistic NMF
np_all_performances = {'R^2': [[0.9980343429144349, 0.995609618431885, 0.9949348087065104, 0.9982636881051925, 0.9980652353035467, 0.9975858464757429, 0.9982870148398022, 0.9979401506447826, 0.9984285716597046, 0.9981641744293244], [0.9978711565756241, 0.9951287961499744, 0.9955681745487412, 0.9977816392170151, 0.9976521250865921, 0.9980295403896086, 0.997967923476359, 0.998133275350781, 0.9977997887661408, 0.9976685147823149], [0.9974878783068148, 0.9977227798620565, 0.9964085132001691, 0.9979066461073346, 0.9976156756353801, 0.9977450435816912, 0.9979100744486454, 0.9978245838548117, 0.9978511881366197, 0.9978482327011712], [0.9977014482955708, 0.9977308797494522, 0.9979366179315533, 0.9974637696425553, 0.997567461760042, 0.997232480770134, 0.9978046385772357, 0.9958527869467003, 0.9976979457890558, 0.9976039928091303], [0.9972873791567107, 0.9974788313451, 0.9974874870493455, 0.9976407323409554, 0.9976075690681417, 0.9968273846950513, 0.9975191092280739, 0.9957221939684213, 0.9940014813239068, 0.9975382659486167], [0.9972760828563136, 0.9973243972377697, 0.9971832708219596, 0.9971215746756694, 0.9959736934524578, 0.9974774945714368, 0.996821475613117, 0.9969160552417984, 0.9974096115578959, 0.997158452666769], [0.9952929262598474, 0.9964297512630778, 0.9460503817431494, 0.9964772516678725, 0.9962207997347254, 0.9963726980531884, 0.9966501497043366, 0.9963737293018352, 0.9966902187552384, 0.9962939159188997], [0.9830150098355507, 0.9874911795421858, 0.8936347493707586, 0.9877260361953338, 0.9909088566617611, 0.9539134425722242, 0.9929213967933344, 0.9899306534387379, 0.9915779962418456, 0.9886991669119036], [0.5248515363916246, -7.024220602118414e+52, 0.7794147157383904, 0.5655423577728611, 0.7067000089738362, 0.36084588195959366, 0.6642642108143817, 0.7581320210169895, 0.7448099035778358, 0.7934430488340981]], 'MSE': [[1.1117273217378305, 2.3256773636075838, 2.9998561716900229, 1.1098033050993086, 1.0948085435040582, 1.2827467330013105, 1.1913980300490594, 1.3028129274095495, 1.1661385896617491, 1.2842719862649354], [1.2245273456719461, 2.3136521304393223, 2.4610859524398383, 1.2236548175424988, 1.2180003141282578, 1.1731739638750209, 1.2046935743663822, 1.2806399258355881, 1.2680535334083713, 1.389284693705213], [1.2588366636023249, 1.2841200803571773, 2.266613268725413, 1.1768216450733573, 1.2377841468514552, 1.2734553909153328, 1.249335830894494, 1.2854355430335669, 1.2189422766194737, 1.2666054721024202], [1.2908570246570437, 1.3556280072018361, 1.2710824575159441, 1.3213661147982978, 1.3277951257577973, 1.4858258783528859, 1.320584587958312, 2.496345993882279, 1.3198053691046701, 1.2930205186768902], [1.4757018569434037, 1.3833886749310353, 1.44261511794411, 1.4716594488218024, 1.374673050139454, 1.7637131189789428, 1.3490298959990301, 2.4682230761075292, 3.1875323257963935, 1.4526496250295395], [1.5802395951361314, 1.5169576690580031, 1.579972485028267, 1.6345701428905648, 2.1646134699942974, 1.5139838888367847, 1.6693633434318642, 1.627937462063324, 1.4939395117947363, 1.6318822480375663], [2.6462347938031714, 1.9774539650171108, 30.404288995593351, 2.0678630459146747, 2.2019393825194209, 2.0155135038322074, 1.8379413250731671, 2.1417047615223836, 1.8689874228503611, 2.1469989037293975], [10.00351199232586, 7.0374960093009928, 61.312164632958066, 7.2479063248142719, 5.1383066740763077, 25.786585434786456, 4.0860549464388924, 5.9186700417560267, 4.8378237060334861, 6.4192980730779574], [277.54525146528437, 4.0054170095568005e+55, 125.49911986794422, 248.68429881964471, 168.28248872197133, 366.69536847829045, 193.99197205474707, 138.75847806416536, 141.69537167011299, 118.56358302693702]], 'Rp': [[0.99901831033550148, 0.99780267323418492, 0.99746532993847858, 0.99913184513114062, 0.99903476674991853, 0.99880402516521027, 0.99914522989985854, 0.99897248918732606, 0.99921789276757178, 0.99908661815973598], [0.99893681373087895, 0.99758801048588652, 0.99778177276524527, 0.99889553637877282, 0.99882707580567365, 0.99901455166763853, 0.99898429732255611, 0.99906725758542458, 0.99890242410479768, 0.99883689243690521], [0.99874389090697591, 0.99886115746120463, 0.99820283070307547, 0.99895416759157307, 0.99881468578807919, 0.99887202005848885, 0.99895486890826601, 0.99891177416512533, 0.99892518952847609, 0.99892397729039517], [0.9988504461615394, 0.99886535314254665, 0.99896950233159876, 0.99873324352209936, 0.99878342543591769, 0.99861580778971792, 0.99890278482331929, 0.99792672022315521, 0.99885055131867329, 0.99880184616905998], [0.9986455214633525, 0.99874135118538232, 0.99874445271605405, 0.99882057829495607, 0.99880509920628302, 0.99841739036749755, 0.99876029963181223, 0.99787641705417718, 0.99700267143790289, 0.99877110190618346], [0.9986420737099263, 0.99866166298444703, 0.99859088348326819, 0.99856286714576636, 0.99798913092482722, 0.99873865443757215, 0.99841445921822869, 0.99845946526067653, 0.99870415634755061, 0.99857935368159356], [0.99765801147108923, 0.99821463763173846, 0.97369867754965167, 0.99823846555228446, 0.99810891026453552, 0.99818580924244882, 0.99832436981576389, 0.99820000427266786, 0.99835221365309634, 0.99814790541981058], [0.99163850472123882, 0.99374088005539329, 0.95099812872284506, 0.99386323564774937, 0.99544851212496843, 0.97746944649188028, 0.99646362300198033, 0.99498800160241041, 0.99578162502496104, 0.99442329673681795], [0.82217943237744207, 0.0086490164132459486, 0.89763285493411682, 0.79763928882156299, 0.87052056847973192, 0.81024677391454336, 0.84867623154677641, 0.89351663603146692, 0.88580704312138958, 0.90926055138610729]]} 
np_average_performances = {'R^2': [0.9975313451510924, 0.9973600934343152, 0.9976320615834695, 0.997459202227143, 0.9969110434124323, 0.9970662108695187, 0.9912851822402171, 0.9759818487563635, -7.024220602118413e+51], 'MSE': [1.4869240972025408, 1.4756766251412441, 1.3517950318175014, 1.4482311077905954, 1.7369186190691241, 1.6413459816271536, 4.9308926099855253, 13.778781783556832, 4.0054170095568004e+54], 'Rp': [0.99876791805689291, 0.99868346322837787, 0.99881645624016591, 0.99872996809176284, 0.99845848832636008, 0.99853427071938561, 0.99571290048730854, 0.98848152541302436, 0.7744128397026383]}



# Assemble the average performances and method names
methods = ['VB-NMTF','G-NMTF', 'ICM-NMTF', 'NP-NMTF']
avr_performances = [
    vb_average_performances,
    gibbs_average_performances,
    icm_average_performances,
    np_average_performances
]

# Also compute the median values
def compute_medians(all_performances):
    medians = {}
    for metric in ['MSE','R^2','Rp']:
        medians[metric] = []
        for performances in all_performances[metric]:
            medians[metric].append(numpy.median(performances))
    return medians
    
median_performances = [
    compute_medians(vb_all_performances),
    compute_medians(gibbs_all_performances),
    compute_medians(icm_all_performances),
    compute_medians(np_all_performances)
]

# What to plot - averages or medians
values_to_plot = avr_performances

# Plot 
for metric in metrics:
    plt.figure()
    #plt.title("Performances (%s) for different fractions of missing values" % metric)
    plt.xlabel("Fraction missing", fontsize=16)
    plt.ylabel(metric, fontsize=16)
    
    x = fractions_unknown
    for method, avr_performance in zip(methods,values_to_plot):
        y = avr_performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', marker='o', label=method)
    plt.legend(loc=0)  
    
    if metric == 'MSE':
        plt.ylim(0,MSE_max)
    else:
        plt.ylim(0,1)