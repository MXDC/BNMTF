"""
Plot the performances of the many different NMF algorithms in a single graph.

We plot the average performance across all 10 attempts for different fractions:
[0.1, 0.2, ..., 0.9].

We use a dataset of I=100, J=80, K=10, with unit mean priors and zero mean unit
variance noise.

We have the following methods:
- VB NMF
- Gibbs NMF

"""

import matplotlib.pyplot as plt
metrics = ['MSE','R^2','Rp']

fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 

# VB NMF
vb_all_performances = {'R^2': [[0.9685702919046254, 0.968045682084366, 0.962904323414863, 0.9655358170654309, 0.9642192825488557, 0.9642645288228704, 0.9616591853182374, 0.9662700453745366, 0.9643056397209069, 0.9678698908385694], [0.9613911946072107, 0.958309331066617, 0.9607915336823158, 0.9601289805320805, 0.9640481957927443, 0.9584420432757917, 0.9590256507257677, 0.9616321075507859, 0.9613474351277094, 0.9643046886284261], [0.9629738980441745, 0.9613200877941165, 0.9624748109172568, 0.9616607518605566, 0.9605178532710996, 0.9617338944298173, 0.9634238690171399, 0.9585944482608576, 0.9593219964381738, 0.9585482122596252], [0.9566462230074624, 0.9526868929251553, 0.9590082047529743, 0.9561088015357431, 0.9558087593265825, 0.959187199804053, 0.957433909633826, 0.9602385846300423, 0.9526318953529053, 0.9550147941115685], [0.9508483325076938, 0.9473325912414196, 0.9542201295513445, 0.9387148419638668, 0.9461988288880533, 0.9543556973969292, 0.9548889970572341, 0.9494131525792536, 0.947982368368051, 0.946638339691099], [0.9288669651149779, 0.9200425409350439, 0.9223013895810983, 0.8976225455058199, 0.9421564058602797, 0.9375973041202069, 0.904296477930529, 0.9137495573267354, 0.913220939545871, 0.9263554591389446], [0.6316079276565392, 0.7295810646381808, 0.7185163606757731, 0.7316318946663913, 0.7959650611524512, 0.8179474459584242, 0.5204958070162373, 0.7861197689258212, 0.7710124317987035, 0.688582887972478], [0.4203534877553149, 0.59690314954304, 0.6313342599433598, 0.5440274885124493, 0.47911999549183604, 0.46445126744988596, 0.6011163741260217, 0.5537326529429252, 0.6139526338827311, 0.5595109489768328], [0.36761783294294237, 0.41524361839944623, 0.4996246600591563, 0.32468314419939703, 0.4565442448301633, 0.46931833014029356, 0.49899933173304845, 0.5314347931766392, 0.4535711888434011, 0.46739305965177913]], 'MSE': [[1.388665241530556, 1.2992594237559698, 1.4674971013374849, 1.2803195666426856, 1.3488037592196047, 1.5143073959897644, 1.460172950545404, 1.3118780126131555, 1.3663537866282556, 1.3011854661195097], [1.6178884702955312, 1.5988462262589109, 1.4858098345560113, 1.46580518997163, 1.3683995470563983, 1.6677175103411404, 1.5310477959005384, 1.5248864273261316, 1.6464796758088398, 1.380050748181141], [1.5273974400354025, 1.5885021947538143, 1.6064867926107167, 1.5092709356517127, 1.4877881350731075, 1.5254627161353091, 1.3843006004383895, 1.5453259718936534, 1.6435411207183312, 1.5842248226492504], [1.5580480894198505, 1.7856862054974847, 1.5733645490866803, 1.7392639983517106, 1.6102598698246899, 1.6591683706986355, 1.7168002397410842, 1.6359090716523397, 1.7257494412036587, 1.9040829805120112], [1.8750268803452803, 2.1354401016414117, 1.8912924634218433, 2.5004824777394195, 2.0823544676881922, 1.8424796637559153, 1.8092187477448378, 1.84723085549676, 2.0376051569959244, 2.017616212410501], [2.9038065108271311, 3.1071858578017713, 2.9115719482292328, 4.1572898368600457, 2.3134559595054758, 2.4655370597182311, 3.864575809336571, 3.3798483793393679, 3.3916620265290258, 2.9044098423107463], [14.854025163759092, 10.337595173541203, 11.12604394962359, 10.841266051646731, 8.3902523464836385, 7.1646165115140947, 19.063862412298171, 8.0535451216416423, 9.0432721461908425, 12.136854582159815], [23.080181499122162, 15.55815855026022, 14.620944544128252, 18.130386287534044, 20.217534626753807, 20.917482657433244, 15.550526749429345, 17.199679247893531, 15.124431700791751, 17.700773940295804], [24.780341189577083, 22.790760552148893, 19.860669445254885, 26.30096657648955, 21.477777775367365, 21.089692636782196, 19.764728657927915, 18.430059143181783, 21.457650108645467, 21.084653478994863]], 'Rp': [[0.9842564859465236, 0.98391205498179957, 0.98127704868266019, 0.98262496047464898, 0.98201637573618494, 0.98200295688650963, 0.98068490940412811, 0.98305343581241877, 0.98200374073518926, 0.98402974308207924], [0.98063365623121723, 0.97895072470392208, 0.98023804922837177, 0.97991182821371259, 0.98187234012577795, 0.97900445701949956, 0.97934428606231005, 0.98068567375508864, 0.98048490285180567, 0.98199581462793339], [0.98131620923734841, 0.98055094296818746, 0.98111921664273871, 0.98065716237414269, 0.98006635549416832, 0.9807653607390574, 0.98155575849813603, 0.97908585235921974, 0.97947286313176907, 0.97905950703675104], [0.97808758041021382, 0.97605692349339657, 0.97930404410331517, 0.97781814414512702, 0.97766346973355445, 0.97944533544609713, 0.97851396160131765, 0.97993629246887692, 0.97603065797313293, 0.97731516789844597], [0.97520522061524606, 0.97340651885331875, 0.97685614774613205, 0.9688969433790201, 0.97273277912367206, 0.97693311893476431, 0.97730734387919671, 0.97438975119884119, 0.97381472490120125, 0.97298775272041871], [0.96380513969737802, 0.95943714830172699, 0.9606621538914254, 0.9477407198751594, 0.97070033594452476, 0.96837353691958494, 0.95120262443063508, 0.95624846605506231, 0.95590332621860596, 0.9624954489503762], [0.81846288613316831, 0.87332956585108701, 0.85434767227848052, 0.87016516983102354, 0.89397502375754734, 0.90654332025743367, 0.77852010413004702, 0.89133425443755843, 0.88376423659636183, 0.83841291579251465], [0.69881471018209007, 0.78368844211616506, 0.79739925326737282, 0.7545595380717407, 0.73713714316859469, 0.71371016825417821, 0.78665768950951631, 0.77617903793439491, 0.79068509798543518, 0.76295075259883605], [0.69240020934698443, 0.70984018995922005, 0.74414500450023835, 0.69471857657893099, 0.73140074184730719, 0.73208978802622016, 0.74105211740518173, 0.75485566679416483, 0.73605664048123842, 0.73420271146341243]]} 
vb_average_performances = {'R^2': [0.96536446870932624, 0.96094211609894487, 0.96105698222928171, 0.95647652650803128, 0.94905932792449443, 0.9206209585059506, 0.71914606504610001, 0.54645022586243974, 0.44844302039762673], 'MSE': [1.373844270438239, 1.5286931425696273, 1.5402300729959688, 1.6908332815988145, 2.0038747027240085, 3.1399343230457597, 11.101133345885881, 17.810009980364214, 21.703729956436998], 'Rp': [0.98258617117421421, 0.98031217328196385, 0.98036492284815202, 0.97801715772734776, 0.97425303013518116, 0.9596568900284479, 0.86088551490652243, 0.76017818330883236, 0.7270761646402899]}

# Gibbs NMF
gibbs_all_performances = {'R^2': [[0.9626604755609737, 0.9603787311650034, 0.955591655257068, 0.9663508033695062, 0.9577839110006067, 0.9644403383690842, 0.9596783108168987, 0.9666094936468191, 0.9691771427784676, 0.9641675239201252], [0.962468385505943, 0.9602455983574255, 0.9602991339174196, 0.9593766752397161, 0.9647849030758828, 0.9616506813432171, 0.9617671506245631, 0.9598060697463329, 0.9610005333662207, 0.9624650811552582], [0.954778446164413, 0.9621067439774655, 0.9523553049168686, 0.9574800620231362, 0.959867571118596, 0.9575520390048355, 0.960484985070348, 0.9577437775162354, 0.9603077848708809, 0.9577478215684656], [0.9579521408928631, 0.9517928166329961, 0.952145306805017, 0.9506513642018861, 0.951781825132771, 0.9538353876227507, 0.9569615435171671, 0.9532632559421764, 0.9551637515500949, 0.9520401953431608], [0.9467063685093521, 0.9467968179896844, 0.9541562869425009, 0.947441831568444, 0.9418411415686906, 0.9373357753195922, 0.9427962320703145, 0.9472292661333436, 0.9394095762288359, 0.9492698951059422], [0.8966190670119877, 0.9011059381799048, 0.9301404125287748, 0.9165143764665863, 0.9223183933460702, 0.9132696314797007, 0.9108125674606494, 0.9283114849430399, 0.8914435332886943, 0.8986676197549808], [0.7145788416516814, 0.77373258717216, 0.7326690975924758, 0.8124325957099922, 0.729806978815355, 0.7575722283605735, 0.8130402082225157, 0.7488645875522285, 0.720456558455631, 0.8094763621968231], [0.5444652324539367, 0.5103280249074915, 0.4112098005647581, 0.5546090346653341, 0.49251881319504953, 0.5819848169177988, 0.5222952535115717, 0.2974574189182677, 0.47339440795053345, 0.43202947088438626], [-0.6362803956028773, -0.9536070158704435, -4.813328071744938, 0.04887957249156971, 0.049726003052194656, -1.328184023576347, -0.401718692424492, -1.6995822292725866, -0.21546236277014796, -2.0516610589619586]], 'MSE': [[1.359345375734484, 1.4826412469656569, 1.5651155242894879, 1.320863579203035, 1.5313029242822085, 1.375868493142181, 1.45965709873376, 1.4172620308914785, 1.4298066263742926, 1.5726206726670213], [1.5058864258732985, 1.5607275716872611, 1.5631774244706012, 1.5377878322368093, 1.4186280636726973, 1.4648531800022053, 1.4321705043682604, 1.6224378707560556, 1.4342347822308488, 1.4972267520806832], [1.8132092558838095, 1.5660963093749463, 1.8323126128374678, 1.6720620593050906, 1.5978027194515427, 1.6285130699866079, 1.6146928644178202, 1.6016876433020868, 1.5328668004307635, 1.6655371080094179], [1.6187007773688991, 1.8039524417203494, 1.8462012471106899, 1.9508854626756382, 1.8296704117440568, 1.7658902433783985, 1.7416580670686777, 1.8118530538407722, 1.7595698153549972, 1.8955072643224278], [2.1107022229607111, 2.0735063159020797, 1.9257030716595811, 2.0531814304663829, 2.2839518860970842, 2.5081380849499122, 2.1676933516701693, 2.0658486732006782, 2.3264121486129588, 2.0242734047167978], [4.0864451456665831, 3.9519534261692724, 2.8509106776093094, 3.391622520534304, 3.2186715299208464, 3.4373288870023591, 3.4928833099320773, 2.7966970987816633, 4.252549283307367, 3.933774374169098], [11.150796293834381, 9.1410642567908074, 10.474713298121015, 7.3528299006474542, 10.679031739262573, 9.7037262007881893, 7.4475591427983003, 10.116012610367816, 10.937075859444153, 7.5201827738389095], [17.898036682097757, 19.421971539949105, 23.161888547819164, 17.656104342542275, 19.840412279218476, 16.82332164133884, 18.908792195142848, 26.770065791889461, 20.633893632342634, 21.831420808155887], [64.901400270030194, 75.956183935148971, 227.94509073604496, 37.730815068822402, 37.353556849595371, 91.478665600043684, 55.34224521405325, 105.1702489654392, 47.068175116844188, 118.97012847408851]], 'Rp': [[0.98115771467591484, 0.98005040141058741, 0.97761081964449914, 0.9830517458977085, 0.97866670860248706, 0.98218117490054435, 0.97988259854571369, 0.98317539584704416, 0.98452716149362962, 0.98201701737956049], [0.98107805110940627, 0.97996095381430115, 0.97996026690643212, 0.97955607364563091, 0.98227711195922263, 0.98064692698603251, 0.98074646169510449, 0.97975029368703204, 0.98038932595180517, 0.98105649771641124], [0.97714117135382572, 0.98090288334951414, 0.97601891708398669, 0.97862210295910512, 0.9797313864849797, 0.97856575351705155, 0.98006131589163847, 0.97870706773226734, 0.97999482686215167, 0.97866737471225229], [0.97876302542177263, 0.97573510584804091, 0.97579869743339653, 0.97503464755728431, 0.97564546854766765, 0.97669959422348762, 0.97824942086623901, 0.97635855708853003, 0.97733637642908378, 0.97575377256336548], [0.97303282344079178, 0.97304179371298682, 0.97681466124585448, 0.97336667055280479, 0.9705566449255113, 0.96818167843388148, 0.97103068541425319, 0.97339234629560123, 0.9693113682172102, 0.97431760858488337], [0.94761505297099247, 0.94957835755852582, 0.96450276369684174, 0.95737607508571532, 0.96069107959054545, 0.9557574017567575, 0.9550230138532152, 0.96349158002221169, 0.94492922464960694, 0.9485913123677755], [0.86284162472036374, 0.88372816849040969, 0.86536986036349828, 0.90496048718824729, 0.86531101573124736, 0.87654574100636462, 0.90361850995027349, 0.87501484440942412, 0.86877906719804454, 0.90377287343748913], [0.77144545485609395, 0.75862357862028162, 0.74381246517671784, 0.77970993414477174, 0.75016017258581336, 0.78696077997990466, 0.75811653422882008, 0.71477053073704222, 0.74884053206087842, 0.75595089817411343], [0.59017916361567924, 0.55797907953349812, 0.3465682807148584, 0.60069890730764675, 0.65308231479493728, 0.53757258564475585, 0.55220553514241466, 0.50253299988344902, 0.62346606191676768, 0.52083793987668614]]} 
gibbs_average_performances = {'R^2': [0.96268383858845541, 0.96138642123319795, 0.95804245362312446, 0.95355875876408835, 0.94529831914367013, 0.91092030244603905, 0.7612630045729436, 0.48202922739691278, -1.2001218274680026], 'MSE': [1.4514483572283605, 1.503713040737872, 1.6524780442999556, 1.8023888784584909, 2.1539410590236354, 3.5412836253092879, 9.4522992075893608, 20.294590746049646, 86.191651023011076], 'Rp': [0.98123207383976896, 0.9805421963471378, 0.97884127999467707, 0.97653746659788676, 0.97230462808237783, 0.95475558615521872, 0.88099421924953636, 0.75683908805644373, 0.54851228684306919]}



# Assemble the average performances and method names
methods = ['VB-NMF','G-NMF']
avr_performances = [
    vb_average_performances,
    gibbs_average_performances
]

for metric in metrics:
    plt.figure()
    plt.title("Performances (%s) for different fractions of missing values" % metric)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)
    
    x = fractions_unknown
    for method, avr_performance in zip(methods,avr_performances):
        y = avr_performance[metric]
        plt.plot(x,y,label=method)
    plt.legend(loc=0)  