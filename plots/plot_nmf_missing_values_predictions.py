"""
Plot the performances of the many different NMF algorithms in a single graph.

We plot the average performance across all 10 attempts for different fractions:
[0.1, 0.2, ..., 0.9].

We use a dataset of I=100, J=80, K=10, with unit mean priors and zero mean unit
variance noise.

We have the following methods:
- VB NMF
- Gibbs NMF

"""

import matplotlib.pyplot as plt
metrics = ['MSE','R^2','Rp']

fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 

# VB NMF
vb_all_performances = {'R^2': [[0.9683268956440504, 0.9622680127633172, 0.9564578497832502, 0.9686125582083285, 0.9626402346288588, 0.9704828021399491, 0.9631752085146694, 0.9664157765496877, 0.9657131329430598, 0.9675500623957437], [0.9668128793867617, 0.9649725918604659, 0.9632517409262052, 0.9644174602941691, 0.9641341691140055, 0.9653704182507935, 0.9673608803622844, 0.9633255017618765, 0.9649349641816077, 0.9631259202872454], [0.961263391664692, 0.9635529194528825, 0.96089094219709, 0.9583550290293237, 0.9627781904894005, 0.9620755106999952, 0.9650649200571768, 0.9645262441187441, 0.9633202614813647, 0.9655063580944588], [0.9587746374054238, 0.9609826563886289, 0.9584787256288252, 0.9596729325844442, 0.9614683874809795, 0.9604389229571111, 0.9580599904628782, 0.9632603188304584, 0.9589038925487329, 0.9611390826617201], [0.954764458767056, 0.9559913923435321, 0.9559601067605867, 0.951826774540038, 0.9534818760742405, 0.9531145943497816, 0.9547945173499108, 0.9536012259976467, 0.9526275157616074, 0.9517975596959926], [0.9439528941080876, 0.9423109009902574, 0.9447308950343285, 0.9437399477037715, 0.9445551304638258, 0.9391119547137795, 0.9378742834039354, 0.9439691505602573, 0.9448146927130339, 0.9366493701445628], [0.9139659581529019, 0.9173029140027594, 0.9126397295080084, 0.9187860455546012, 0.9097022561133451, 0.911664454276852, 0.9184278469663721, 0.9222851500766729, 0.9121065999489419, 0.9178396808876127], [0.48321642713724744, 0.6721557075353298, 0.66405104137267, 0.5619347344522456, 0.6090619078021668, 0.5712282509961932, 0.6355162766945378, 0.6541847837527741, 0.5148055904011977, 0.6639106618565304], [0.4551211904673692, 0.46702520074307785, 0.45714938243319736, 0.4320066506226914, 0.4889259817646492, 0.3945633736553511, 0.49848196468095407, 0.5059858824827626, 0.5221897319741899, 0.49733543815009784]], 'MSE': [[1.2779047987236716, 1.4424212972276842, 1.4155205918810136, 1.3185645605655991, 1.3110768923521476, 1.3209240174928363, 1.3567714336601278, 1.2797862211939102, 1.3083430374435647, 1.2334046158887788], [1.3767637548207068, 1.3509902742278665, 1.4015906378047365, 1.4373153566293808, 1.2770067952395576, 1.3743787717887128, 1.3733036300770494, 1.3791996007537144, 1.4439861887507712, 1.4745950508047372], [1.5028590831265696, 1.431562451751651, 1.505492451728849, 1.5231418375129426, 1.4563969556275225, 1.4706690449818176, 1.4526277501987104, 1.4314812991055481, 1.505119053070727, 1.4119741917053541], [1.5984859192289134, 1.533722304629106, 1.5525440652731282, 1.5972020961478282, 1.6008625491795883, 1.5129740287205482, 1.5685354437235823, 1.5460600481927604, 1.5846551579057047, 1.5134054923660201], [1.7827267026443885, 1.7176131986322376, 1.739101954012785, 1.8631982112390979, 1.8260263113690163, 1.863743429264165, 1.6937004576796619, 1.7605994799076821, 1.8439964654285184, 1.8812163840008509], [2.1347150829020789, 2.2307406415388691, 2.1860759279826545, 2.1744890689063299, 2.2094488407494279, 2.3692634980515139, 2.4461789651316863, 2.1998853196455026, 2.2086528070286477, 2.4498446956982782], [3.3711158944936046, 3.3234455829346112, 3.4682354625486682, 3.1853982776896999, 3.644984043701724, 3.4353732562947186, 3.147456583879928, 3.0933649386090338, 3.4190569633138925, 3.1592387168584719], [19.981448664998737, 12.717772015093344, 13.295733278581803, 17.421393906149316, 15.385219907594717, 17.04778441647397, 14.143789937820598, 13.474509958589959, 19.387869840232518, 12.835419528621093], [21.821582719498554, 21.120528553915918, 21.326353048210866, 22.244014572174358, 20.25110037734148, 23.7549942873788, 19.835060652135102, 19.627127669265086, 18.646049324113843, 19.728594588334168]], 'Rp': [[0.98404484435447881, 0.98099202509781114, 0.9780783097009611, 0.98424873358620502, 0.98118521481558152, 0.98515544390951815, 0.98153545015477517, 0.98314050352979132, 0.98271968091831485, 0.98365811707990825], [0.98328170001381732, 0.98233214521567447, 0.98145948860282972, 0.98206425180716006, 0.9819166131466609, 0.9826870812454801, 0.98354781224204579, 0.98169373633926338, 0.98241188639574983, 0.98140140280826993], [0.98054581847120248, 0.98161866527204056, 0.98025840514925289, 0.9789664886133711, 0.98122102568678138, 0.9808853045091136, 0.98237939999984314, 0.98210739151564508, 0.98156966539193069, 0.98260479759112751], [0.979184843057333, 0.98032679507780029, 0.97903420276664876, 0.97964267350568324, 0.98057721087525096, 0.98002379960120256, 0.97890482486201136, 0.9814593749087388, 0.97926188098613953, 0.98040576289087278], [0.97713007560938503, 0.97777348530830377, 0.97776191778009958, 0.97575095674351975, 0.97649265211060576, 0.97627936137405325, 0.97716520890883918, 0.97656715824589535, 0.97614155051790052, 0.97565687726399386], [0.97162454967309775, 0.97079136120154863, 0.97199635949662444, 0.97148849344457866, 0.97193676151423003, 0.96913315351291585, 0.96857058694461418, 0.97161601719073154, 0.97201644844364476, 0.96782227465613724], [0.9561623612330068, 0.95777945349108407, 0.95538235593178422, 0.95855935472315645, 0.95396604383963812, 0.95491115708712582, 0.9585720014739193, 0.96047694297096209, 0.95522860338656879, 0.95808484749548806], [0.7581379233444161, 0.82151656993675515, 0.82292942982743689, 0.76006747806085018, 0.79083651604487692, 0.77011871430496148, 0.80519628598061466, 0.81714981538102116, 0.74100128402712007, 0.82216742824805455], [0.71480341395189406, 0.73458025038787111, 0.72442951034494751, 0.71405742539700745, 0.73614225722425253, 0.7113442001417507, 0.74640125485862741, 0.74148090686190837, 0.76348357148697066, 0.7382841503099199]]} 
vb_average_performances = {'R^2': [0.96516425335709144, 0.96477065264254147, 0.96273337672851278, 0.96011795469492012, 0.95379600216403926, 0.94217092198358399, 0.91547206354880672, 0.6030065382000892, 0.47187847969743413], 'MSE': [1.3264717466429337, 1.3889130060897235, 1.469132411880969, 1.560844710536718, 1.7971922594178402, 2.2609294847634986, 3.3247669720324353, 15.569094145415608, 20.835540579236817], 'Rp': [0.98247583231473445, 0.98227961178169509, 0.98121569622003091, 0.97988213685316816, 0.9766719243862596, 0.97069960060781235, 0.95691231216327333, 0.79091214451561076, 0.73250069409651497]}

# Gibbs NMF
gibbs_all_performances = {'R^2': [[0.9701584814645032, 0.9599502283975455, 0.9628512877164099, 0.9651447909493395, 0.9645594388728109, 0.9629236867057959, 0.965480711097801, 0.9672650787300138, 0.9644300028900268, 0.9696188438168064], [0.9630925785329343, 0.9630497485310692, 0.9631966982165028, 0.9619146065038624, 0.9631105417723419, 0.965206863804326, 0.9683605247362947, 0.9609678563453216, 0.9629115694626478, 0.9666327298911083], [0.9614401946503914, 0.9653926816338954, 0.961093666343247, 0.9639286250628646, 0.9624221526101766, 0.9604493409926124, 0.9646708257591314, 0.9640131189317948, 0.9618538223981573, 0.9617471938185164], [0.9574936957486707, 0.959442830277626, 0.9615709793474864, 0.9580617038230173, 0.9577716615698963, 0.9578439923475299, 0.9588787769676776, 0.9594468351068008, 0.9560746674325419, 0.9588914600695237], [0.9512640520653612, 0.9566753209256326, 0.9549180849407346, 0.9525112021983576, 0.9510493385050873, 0.9562379650078758, 0.9515195425731597, 0.9523247513285765, 0.9533442189690569, 0.9497819444422344], [0.9435445655802267, 0.9433594555714293, 0.9431257688341249, 0.939921605539268, 0.9391778581219182, 0.9386899954004208, 0.9421198961173215, 0.9469925685042494, 0.9415895865147955, 0.9397382639618651], [0.9237215218303259, 0.9186622229145512, 0.9147040688761839, 0.9124329647880693, 0.9098615887805839, 0.8991354967231567, 0.9106060388206313, 0.9015304018448865, 0.90931458225138, 0.9090496794086134], [0.6412495061866536, 0.6129847507327288, 0.6813281509981985, 0.6215014258170131, 0.7382295686302731, 0.5715610650455593, 0.580429661026634, 0.5554924150062309, 0.6856131584608056, 0.6412402631780286], [0.2983914075948395, 0.35983336605050353, 0.46653926729959727, 0.12213469142361588, 0.35423754677182184, 0.1911345556549049, 0.15068844374117574, 0.16445830177570597, 0.17968266142085276, 0.012361040735155981]], 'MSE': [[1.245509072980908, 1.418672866207368, 1.2683778429122223, 1.4333135427976271, 1.2626667327830405, 1.4171678722592893, 1.3647983955611622, 1.298909542810706, 1.358642606370613, 1.3529166437683984], [1.4636884172940663, 1.3500674978434131, 1.4623133001502524, 1.4810150869734131, 1.3980070364739412, 1.4114647081015586, 1.2958171572078019, 1.4195707677099501, 1.458397682460697, 1.3513610418097204], [1.4990746906967864, 1.4116572189365848, 1.4901900824117684, 1.4561393641266591, 1.5216134227534917, 1.4726068071538987, 1.4404989992507125, 1.5132820335546435, 1.4756327517197385, 1.5387306066967401], [1.6656920347038215, 1.5711692506475885, 1.6014931999259776, 1.613779800811918, 1.6010577531015111, 1.6591151787481133, 1.6128597067913282, 1.5967446288381972, 1.7158054269035532, 1.6149461454948304], [1.8356714166189214, 1.7417502667909912, 1.7426777067275585, 1.8806701344727956, 1.8741855304526625, 1.7620276514951141, 1.9311679028890187, 1.7764558085235187, 1.820676412535009, 1.8904026037552015], [2.189844438369803, 2.1604596187843068, 2.1903592679345478, 2.3076406755388064, 2.4827799530629617, 2.3407620013943236, 2.2640278387961268, 2.0723716456102466, 2.3675836064666029, 2.3358763265245535], [2.9908517729120305, 3.1645313212993575, 3.3369345367773544, 3.4334809091623453, 3.6089579670195837, 3.8943718831820022, 3.5303391837254079, 3.7977911489883378, 3.5251573992882017, 3.6085891656071318], [14.343289206274417, 15.167568620846479, 12.610002958831149, 14.786339402716102, 10.125103871224889, 16.945014499890043, 16.919277041630504, 17.512947481107336, 12.382196662042263, 14.082774837967412], [27.85045005474235, 25.251765457579729, 20.864181023275702, 34.084633944411777, 25.120571433951834, 31.583707812338147, 33.226039033862605, 32.316915924770683, 32.276830099734497, 38.806875677997226]], 'Rp': [[0.98515595390517496, 0.97994726309838809, 0.98130945198240549, 0.98264422392609696, 0.98217554596579781, 0.98154185113397074, 0.98265166634746204, 0.98359415583563481, 0.98208338518484006, 0.98479092882999753], [0.9816543664432994, 0.98136101913791374, 0.98173303777753729, 0.98101559776760794, 0.9815772723705174, 0.98266284999946685, 0.98429631131343842, 0.980396487420924, 0.98135571083680906, 0.98337303609786852], [0.98069711277968508, 0.98260822546990578, 0.98064818783516128, 0.9819057374030733, 0.98117291034938514, 0.98007768590212696, 0.98260289596350792, 0.98208118290841728, 0.98082917442938877, 0.98079090497528454], [0.97886451266136554, 0.97962647904665412, 0.98071101002308136, 0.97881050081123355, 0.97894484168390061, 0.97897532618922145, 0.97935075540821415, 0.97970463498937355, 0.97794287447996742, 0.97951604457216479], [0.97564709684144868, 0.97845135003594852, 0.97770416846342967, 0.97603155886824677, 0.97552389460933508, 0.97799160648563099, 0.97590336594100358, 0.97622228787393184, 0.97644730976557259, 0.97494231340778081], [0.97180146700442294, 0.97155072548121624, 0.97160262923904561, 0.96992782494160679, 0.96934338766578809, 0.96932947956281046, 0.97141583032236078, 0.97345596219571484, 0.97063215736309361, 0.96983085710616523], [0.96179772378843997, 0.95897453273913036, 0.95710257287487566, 0.95623137466962749, 0.95444849987164149, 0.95068391028402499, 0.95481591104840535, 0.95120677868219761, 0.9551948265595388, 0.95419351392925744], [0.82159051119260895, 0.81666384626782584, 0.83534440185305114, 0.82464794359012561, 0.87123963149019468, 0.79934338770455571, 0.79885513732779223, 0.79004489372243669, 0.84190245583852952, 0.81867965885106453], [0.6952967577529241, 0.72651652293152313, 0.74848813714269635, 0.67984597284219472, 0.74007172117622622, 0.67630017707248891, 0.70182225781936458, 0.70038545522381612, 0.67310047383222016, 0.64256085537517127]]} 
gibbs_average_performances = {'R^2': [0.96523825506410543, 0.963844371779641, 0.96270116222007862, 0.95854766026907701, 0.95296264209560777, 0.94182595641456213, 0.91090185662383827, 0.63296299650821253, 0.22994612824681732], 'MSE': [1.3420975118451337, 1.4091702696024817, 1.4819425977301024, 1.625266312596684, 1.8255685434260791, 2.2711705372482283, 3.4891005287961754, 14.487451458253059, 30.138197046266452], 'Rp': [0.98258944262097692, 0.98194256891653819, 0.98134140180159357, 0.9792446979865177, 0.97648649522923281, 0.97088903208822241, 0.95546496444471385, 0.8218311867838185, 0.69843883311686261]}



# Assemble the average performances and method names
methods = ['VB-NMF','G-NMF']
avr_performances = [
    vb_average_performances,
    gibbs_average_performances
]

for metric in metrics:
    plt.figure()
    plt.title("Performances (%s) for different fractions of missing values" % metric)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)
    
    x = fractions_unknown
    for method, avr_performance in zip(methods,avr_performances):
        y = avr_performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', marker='o', label=method)
    plt.legend(loc=0)  