"""
Plot the convergence of the many different NMF algorithms in a single graph.

We run our method on the entire random dataset, so no test set.

We use a dataset of I=100, J=80, K=10, with unit mean priors and zero mean unit
variance noise.

We have the following methods:
- VB NMF
- Gibbs NMF

"""

import matplotlib.pyplot as plt
metrics = ['MSE']#,'R^2','Rp']
MSE_max = 10
iterations = range(0,200)

# VB NMF
vb_all_performances = {'R^2': [-688.5511174525433, -15.20864296747169, 0.5862945582589986, 0.6884036465459529, 0.6952399461921066, 0.7136280156223966, 0.73975874746943, 0.7714539025328889, 0.805807507154146, 0.8595039571939112, 0.9015223147668299, 0.91915929465708, 0.9291579528911349, 0.9368992797921408, 0.9424864420743768, 0.9466779147703466, 0.9502480009853017, 0.9534667318545337, 0.9562473693643262, 0.9584450853965566, 0.960135955213673, 0.9615249889909642, 0.9628007504160377, 0.9640787773532875, 0.9654127847307932, 0.9668059320674439, 0.9681968750743277, 0.9694851041443624, 0.9705913805014224, 0.9714921379780641, 0.9722178462927836, 0.972814841483407, 0.9733215724458553, 0.9737657020801425, 0.974164440639246, 0.9745280724828671, 0.9748631749077985, 0.9751740925376916, 0.9754638125054782, 0.9757345019402731, 0.9759878514485072, 0.976225269484529, 0.9764479628133159, 0.9766569542513406, 0.976853064238053, 0.9770369121914881, 0.9772089661827834, 0.9773696175153451, 0.977519239943313, 0.9776582098742396, 0.977786899603996, 0.9779056898924835, 0.9780150189529712, 0.978115424407641, 0.9782075413711868, 0.9782920547290463, 0.9783696435298597, 0.9784409481717153, 0.9785065581624411, 0.9785670098859202, 0.9786227882321968, 0.9786743296317223, 0.9787220256764306, 0.9787662270683377, 0.9788072477221452, 0.9788453688014459, 0.9788808424872076, 0.9789138953779806, 0.9789447315079094, 0.9789735349952896, 0.979000472336416, 0.9790256943743213, 0.9790493379959492, 0.9790715276222646, 0.9790923765432219, 0.9791119881208689, 0.9791304568562478, 0.9791478693041263, 0.9791643048278817, 0.9791798362068106, 0.9791945301268531, 0.9792084475945511, 0.9792216443118444, 0.9792341710398913, 0.9792460739683979, 0.9792573950964119, 0.9792681726225773, 0.9792784413373915, 0.9792882330065412, 0.9792975767328557, 0.9793064992851472, 0.9793150253853036, 0.9793231779498053, 0.9793309782869315, 0.9793384462548927, 0.9793456003881638, 0.9793524579994975, 0.9793590352641223, 0.9793653472912554, 0.9793714081868287, 0.9793772311104008, 0.9793828283285714, 0.9793882112666611, 0.9793933905598897, 0.979398376104721, 0.9794031771105176, 0.9794078021511964, 0.9794122592162526, 0.9794165557603609, 0.9794206987507346, 0.9794246947115288, 0.9794285497647468, 0.9794322696673273, 0.9794358598443111, 0.9794393254181807, 0.979442671234624, 0.9794459018850831, 0.9794490217264993, 0.9794520348986987, 0.9794549453398219, 0.9794577568001717, 0.9794604728547749, 0.9794630969148956, 0.9794656322386485, 0.9794680819408097, 0.9794704490018604, 0.9794727362762662, 0.9794749464999778, 0.9794770822971431, 0.9794791461860437, 0.9794811405843101, 0.9794830678135209, 0.9794849301033491, 0.9794867295954669, 0.9794884683474461, 0.9794901483368912, 0.9794917714659958, 0.9794933395666263, 0.9794948544059237, 0.9794963176922862, 0.9794977310814874, 0.9794990961826118, 0.9795004145634709, 0.979501687755211, 0.9795029172558991, 0.9795041045330032, 0.979505251024779, 0.9795063581406938, 0.9795074272610669, 0.9795084597361526, 0.9795094568848829, 0.979510419993466, 0.9795113503140062, 0.9795122490632575, 0.9795131174215995, 0.9795139565322791, 0.979514767500944, 0.979515551395477, 0.9795163092461247, 0.9795170420459083, 0.9795177507512938, 0.9795184362830954, 0.9795190995275771, 0.9795197413377071, 0.9795203625345204, 0.9795209639085344, 0.9795215462211689, 0.9795221102061189, 0.9795226565706414, 0.979523185996724, 0.9795236991421167, 0.9795241966412168, 0.9795246791058162, 0.9795251471257189, 0.9795256012692509, 0.9795260420836881, 0.9795264700956235, 0.9795268858113012, 0.9795272897169378, 0.9795276822790492, 0.9795280639447965, 0.9795284351423608, 0.9795287962813533, 0.9795291477532615, 0.9795294899319337, 0.9795298231740941, 0.9795301478198937, 0.9795304641934796, 0.979530772603588, 0.9795310733441492, 0.9795313666949012, 0.979531652922005, 0.9795319322786595, 0.9795322050057088, 0.9795324713322408, 0.9795327314761709, 0.979532985644813, 0.9795332340354296, 0.9795334768357655, 0.9795337142245595], 'MSE': [27114.696407222891, 637.360192903045, 16.267825794068571, 12.252667440692932, 11.983848806711064, 11.260788677450138, 10.23326969735129, 8.9869451169481724, 7.6360843377786551, 5.5246194961977855, 3.8723634410863434, 3.1788378370221326, 2.7856681710841511, 2.4812618357202059, 2.2615620843509494, 2.0967439776524213, 1.956360180982289, 1.8297924644970955, 1.720451561425105, 1.6340324381795905, 1.5675436448256961, 1.512923721490981, 1.4627579210834454, 1.4125030356562398, 1.3600468737698064, 1.3052651960555113, 1.250570197531347, 1.1999141413625247, 1.1564128739365691, 1.1209930698096371, 1.0924565913154625, 1.0689814015280428, 1.0490556036297187, 1.0315914303518354, 1.0159121359495737, 1.0016133163345642, 0.98843633744588033, 0.97621035893778807, 0.96481792004411193, 0.95417380438779609, 0.94421153353242782, 0.93487572389424523, 0.9261189227679153, 0.91790091071584234, 0.91018942621883236, 0.90296011237056828, 0.89619456356418403, 0.8898773928721585, 0.88399390344348361, 0.87852929408902869, 0.87346892530018005, 0.86879782474368195, 0.86449876089101263, 0.86055059323223138, 0.85692834763319781, 0.85360509286249964, 0.85055412720468793, 0.84775026877068926, 0.84517033679061704, 0.84279323944722584, 0.84059990977650212, 0.83857318635431721, 0.83669767090758862, 0.83495957304652713, 0.83334654894103766, 0.83184754260808935, 0.83045263772644784, 0.82915292393292905, 0.82794037814737109, 0.82680776042547244, 0.8257485237595138, 0.82475673666314719, 0.82382701643475242, 0.82295447056294535, 0.82213464423264648, 0.82136347301632273, 0.82063724092105139, 0.8199525444192487, 0.81930626276493135, 0.81869553411294105, 0.81811773622254591, 0.81757047017969842, 0.81705154565920246, 0.81655896661847804, 0.81609091677467926, 0.81564574463107031, 0.81522194813128857, 0.81481815923495649, 0.81443312884403318, 0.81406571257000271, 0.81371485780312602, 0.8133795924233348, 0.81305901530322233, 0.81275228855345905, 0.81245863130467644, 0.81217731473975308, 0.81190765808241816, 0.81164902528642191, 0.81140082222344845, 0.81116249421662379, 0.81093352380258832, 0.81071342863113915, 0.81050175943303415, 0.81029809800758978, 0.8101020552036492, 0.80991326888842363, 0.80973140191627002, 0.80955614012231769, 0.8093871903720391, 0.80922427869898517, 0.80906714855874284, 0.80891555922041092, 0.80876928430825135, 0.80862811049749361, 0.8084918363606356, 0.8083602713543574, 0.80823323493286936, 0.80811055577145929, 0.80799207108288063, 0.80787762601061774, 0.80776707308435258, 0.80766027172600585, 0.8075570877970305, 0.80745739318105225, 0.80736106539808161, 0.80726798724891646, 0.8071780464895657, 0.80709113553631684, 0.8070071512017859, 0.80692599446149382, 0.80684757024878473, 0.80677178727398269, 0.80669855786134625, 0.80662779779552163, 0.80655942616816967, 0.80649336521544379, 0.80642954013882961, 0.80636787890522732, 0.80630831202669706, 0.80625077232518694, 0.80619519469195866, 0.8061415158542119, 0.80608967416207078, 0.80603960940744546, 0.80599126268296151, 0.80594457628450278, 0.80589949365661551, 0.80585595937590293, 0.80581391916509393, 0.80577331992917023, 0.80573410980477533, 0.80569623821530456, 0.80565965592521871, 0.80562431508901533, 0.80559016929152094, 0.80555717357771073, 0.80552528447103466, 0.80549445997994296, 0.80546465959282942, 0.80543584426187242, 0.80540797637669115, 0.8053810197287965, 0.80535493946830572, 0.80532970205459142, 0.80530527520272566, 0.80528162782778234, 0.80525872998902814, 0.8052365528359372, 0.80521506855757086, 0.80519425033664505, 0.8051740723089682, 0.8051545095286019, 0.80513553793852188, 0.80511713434630949, 0.80509927640411516, 0.80508194259182075, 0.80506511220261023, 0.80504876532983116, 0.80503288285435159, 0.8050174464317259, 0.805002438478574, 0.80498784215785346, 0.80497364136273719, 0.8049598206990527, 0.80494636546625398, 0.80493326163713541, 0.80492049583621006, 0.80490805531727505, 0.80489592794013265, 0.80488410214678952, 0.80487256693731946, 0.80486131184567078, 0.80485032691549818, 0.80483960267626686, 0.804829130119739, 0.80481890067697137, 0.80480890619593826, 0.80479913891982546, 0.80478959146608231, 0.8047802568063076], 'Rp': [0.028548944611970516, 0.57461920394105237, 0.81917652007941411, 0.83098728901810559, 0.83409887940611194, 0.84513150818256833, 0.86060616700561288, 0.87899315996066729, 0.89852152099494265, 0.92831432008005832, 0.95050653431702758, 0.95925268401685881, 0.96429078570487581, 0.96820556873640551, 0.97101516679471023, 0.97313722262498015, 0.97495942374759559, 0.97660780742691322, 0.97802805115500679, 0.97914538759774006, 0.98000511279224489, 0.98070999417860483, 0.98135722564790473, 0.98200682554056207, 0.98268603472978999, 0.98339517691376566, 0.98410089958027036, 0.98475088625703255, 0.98530533180008961, 0.98575320030019098, 0.98611123808619572, 0.98640413480417621, 0.98665201643931066, 0.9868691164790977, 0.9870641961899187, 0.98724241685272818, 0.98740699865010162, 0.98756000075617034, 0.98770280044674141, 0.98783638448434308, 0.98796152572425722, 0.98807887706605924, 0.98818900851916847, 0.98829241174815219, 0.9883894856487816, 0.98848053292070959, 0.98856578256110894, 0.98864542576632142, 0.9887196439069188, 0.98878861625972192, 0.98885251471833446, 0.9889115132426578, 0.98896582210955819, 0.98901571326506743, 0.98906151077699644, 0.98910355791004712, 0.9891421885609325, 0.98917771410617961, 0.98921041997674286, 0.98924056590875764, 0.98926838733657607, 0.98929409710429894, 0.98931788724447534, 0.98933993075804483, 0.9893603833675515, 0.98937938519980739, 0.98939706236007041, 0.98941352839074193, 0.98942888562273634, 0.98944322641592375, 0.9894566342731671, 0.98946918481983592, 0.98948094665916431, 0.98949198212764156, 0.9895023479728654, 0.98951209596537848, 0.98952127344197993, 0.98952992377209914, 0.98953808674195309, 0.98954579886149896, 0.98955309360867627, 0.98956000163142177, 0.98956655092683921, 0.98957276701321617, 0.98957867310451608, 0.98958429029181838, 0.98958963773199116, 0.98959473284082111, 0.98959959148537024, 0.98960422816902316, 0.98960865620239891, 0.98961288785464541, 0.989616934481931, 0.98962080663298868, 0.98962451413378372, 0.9896280661547453, 0.98963147126453155, 0.98963473747355823, 0.9896378722701985, 0.98964088265168126, 0.98964377515155399, 0.9896465558649773, 0.98964923047279418, 0.98965180426558419, 0.98965428216767293, 0.98965666876168101, 0.98965896831327171, 0.98966118479591303, 0.98966332191517348, 0.9896653831321478, 0.98966737168557661, 0.98966929061237585, 0.9896711427662459, 0.9896729308344947, 0.98967465735283333, 0.98967632471847244, 0.98967793520154046, 0.98967949095512731, 0.98968099402408694, 0.98968244635287728, 0.98968384979265067, 0.98968520610759547, 0.98968651698084853, 0.98968778401990065, 0.98968900876164334, 0.98969019267691494, 0.98969133717471469, 0.9896924436059964, 0.98969351326689681, 0.98969454740164386, 0.9896955472048945, 0.98969651382377377, 0.98969744835959161, 0.98969835186935717, 0.98969922536731092, 0.98970006982650982, 0.9897008861807961, 0.9897016753269503, 0.98970243812732184, 0.98970317541281905, 0.98970388798597342, 0.98970457662417788, 0.98970524208274657, 0.98970588509762614, 0.98970650638772162, 0.98970710665661021, 0.9897076865937815, 0.98970824687528403, 0.98970878816399421, 0.9897093111094708, 0.98970981634764332, 0.98971030450028452, 0.98971077617445757, 0.98971123196203636, 0.98971167243912794, 0.98971209816573391, 0.98971250968546265, 0.98971290752530028, 0.98971329219557125, 0.98971366419001283, 0.98971402398587671, 0.98971437204421631, 0.98971470881021528, 0.98971503471357425, 0.98971535016899914, 0.98971565557670305, 0.98971595132286849, 0.98971623778020579, 0.98971651530841376, 0.98971678425464171, 0.98971704495388124, 0.98971729772934547, 0.98971754289274894, 0.98971778074458805, 0.98971801157436601, 0.98971823566077843, 0.98971845327187957, 0.98971866466526981, 0.98971887008822967, 0.98971906977792112, 0.98971926396150167, 0.98971945285643192, 0.98971963667057328, 0.98971981560250899, 0.98971998984176668, 0.98972015956908543, 0.98972032495671014, 0.98972048616869235, 0.98972064336121246, 0.9897207966828675, 0.98972094627504881, 0.98972109227216365, 0.98972123480206242, 0.98972137398626658, 0.98972150994035824, 0.98972164277420938, 0.98972177259231087, 0.98972189949405109, 0.98972202357399996, 0.9897221449221697]}

# Gibbs NMF
gibbs_all_performances = {'R^2': [0.5874084878121256, 0.6968575094174961, 0.7438150501278078, 0.8081103649542194, 0.8588449597144766, 0.8846677603553285, 0.9014806302366201, 0.9143249929550229, 0.9240016742523642, 0.9316092583881211, 0.9368493082653059, 0.9423049007709001, 0.9470821306681992, 0.951006618301034, 0.9545801753260581, 0.9570420167437889, 0.959813595486564, 0.9617482162402421, 0.9638261428596557, 0.965156140364875, 0.9665798513942868, 0.9683231488858309, 0.9691834804363861, 0.9693256894861841, 0.9701097222512446, 0.9707695915035803, 0.9706317053661928, 0.9708937783680278, 0.9712771298873855, 0.9715887504577357, 0.9720486620879139, 0.9717835059703902, 0.9719902288224801, 0.9717587542492996, 0.9718502531429035, 0.9717937436145887, 0.9722996105699292, 0.9726734319534867, 0.9729412502494873, 0.9730288621470177, 0.9728678952626644, 0.972782719067991, 0.9727218629086913, 0.9727862306820765, 0.9728219826333189, 0.9725745610346578, 0.9733314299291049, 0.9732612319477381, 0.973316959388951, 0.9730614134520519, 0.9730523075210362, 0.972861114632972, 0.9730989978412297, 0.9736434793589386, 0.9739515964775993, 0.9737273606044639, 0.9736705897545364, 0.974110772234789, 0.9740215476598245, 0.9740369877881883, 0.9740929186756776, 0.9742603518322159, 0.9743155846252362, 0.9739297415393755, 0.9739616743257331, 0.9740771634017203, 0.973831642717771, 0.9737776638251673, 0.9738758110852178, 0.973874812328321, 0.9737645771199395, 0.9738047741552153, 0.9741565600679803, 0.9740198205069471, 0.974395266737997, 0.974285982460653, 0.9742700271413154, 0.9741955232538795, 0.97417248184823, 0.9741876101410045, 0.9741205809646545, 0.9743646603926195, 0.9741958780257791, 0.973838418991211, 0.9742293679263851, 0.9742185217640112, 0.974449884321389, 0.9742595327903472, 0.9743112209015388, 0.9743073433889272, 0.9741704999526878, 0.9742284910630489, 0.9743197199103137, 0.9742366466054992, 0.9740449953161897, 0.9740627243579155, 0.9740229913149574, 0.9743163364244402, 0.9742121908428981, 0.9742379614450866, 0.9743361114844777, 0.974393856251815, 0.9743233886583487, 0.974547400215783, 0.9745674128464484, 0.9744922171716852, 0.9745986819555789, 0.9741904841710205, 0.974327158568242, 0.9740360566649877, 0.9742108739173541, 0.9743716808412197, 0.9743181494764056, 0.9743371825590994, 0.9744180187655346, 0.9741971862659029, 0.9743132100528112, 0.9742157306590223, 0.9745152112804452, 0.9742524632987778, 0.9742892598382283, 0.9744594970454822, 0.9744111776773939, 0.9743796440634348, 0.9742770407273198, 0.9740312691206398, 0.9741460034431412, 0.9743146818423831, 0.9744092940292278, 0.9739909729343131, 0.9744881024097435, 0.974248166787449, 0.9743639527656875, 0.9744541164437891, 0.9745765261193966, 0.9742760843042031, 0.9740571491334008, 0.9744735729985444, 0.9745401231632039, 0.9743461245232651, 0.974100088245077, 0.9738736732533884, 0.9744268434052776, 0.9746623821623084, 0.9743333390910394, 0.9746318892952087, 0.9743183589462627, 0.9745609045208568, 0.9746073799004449, 0.9744957345001413, 0.9744857208638376, 0.9745482293019533, 0.9741958141558219, 0.9739747125581331, 0.9738843527297539, 0.9741445070520781, 0.9739288204367405, 0.9742707845082201, 0.9746398291526907, 0.974633484506776, 0.9746053747067431, 0.9744575984511934, 0.9741839582690497, 0.9739913199769975, 0.9744956607981314, 0.9745505393997153, 0.9748921861628295, 0.9743191384506201, 0.9744289327155766, 0.9745218450795281, 0.9743260140233551, 0.9740611369850729, 0.9743894393879862, 0.9741267286381011, 0.9744594644773773, 0.9745928478946054, 0.9746919305424708, 0.9743701431335766, 0.9744258614773732, 0.9741299108427287, 0.9742149604526138, 0.9743957636503576, 0.9747784804257431, 0.9745511567790089, 0.9745535575156005, 0.9745215404314803, 0.9744038550542495, 0.9744024772369615, 0.9745301345042953, 0.9745620634205137, 0.9747431247606514, 0.9745286969391298, 0.9741591164687059, 0.9739259008283162, 0.9740279795289692, 0.9741677755548058, 0.9743748297569736, 0.9742453325667317, 0.974408933174864, 0.9742098113928572], 'MSE': [16.224023585809295, 11.920242592949917, 10.073766779679207, 7.5455308044181733, 5.5505327550349355, 4.5351223205661295, 3.8740025703008594, 3.3689334219244653, 2.9884246112416695, 2.6892773413546744, 2.4832268282274184, 2.2687006955496773, 2.0808493020064143, 1.9265296467626749, 1.786009370056578, 1.6892042442943216, 1.58021955225772, 1.5041459254135103, 1.4224371905338726, 1.3701387058187549, 1.3141551951593384, 1.245604828066436, 1.2117746620171952, 1.2061826832442846, 1.1753527565573874, 1.149405217654623, 1.1548272098164771, 1.144521911628378, 1.1294476701377245, 1.1171940504343618, 1.0991092936834748, 1.1095358268950097, 1.1014070207296887, 1.1105091200794335, 1.1069111783766763, 1.1091332597649719, 1.0892414365638476, 1.0745419413862711, 1.0640107253464988, 1.0605656290467909, 1.066895207942955, 1.0702445269437375, 1.0726375276106239, 1.0701064424023308, 1.0687005954979192, 1.0784297676542494, 1.0486679852807801, 1.0514283273424332, 1.0492369993729802, 1.0592856387294327, 1.0596437043590099, 1.0671618375095056, 1.0578077362557627, 1.0363975018607183, 1.0242816457350434, 1.0330991031646524, 1.0353314603048311, 1.0180224979759429, 1.0215310083691465, 1.0209238678940211, 1.0187245399607114, 1.0121406927402012, 1.0099688154470439, 1.0251410309204765, 1.023885362144648, 1.0193440726673531, 1.0289984965940016, 1.0311210677106335, 1.0272616973287809, 1.0273009706898952, 1.0316356663099853, 1.0300550287323118, 1.0162220176856422, 1.0215989238938026, 1.0068355360687433, 1.0111328389477712, 1.0117602378874162, 1.0146898978326333, 1.0155959375781587, 1.0150010591777645, 1.0176367967194124, 1.0080390462104019, 1.0146759474058871, 1.0287320383250662, 1.0133590494056415, 1.0137855448350725, 1.0046878501979115, 1.0121728993033594, 1.0101404068494277, 1.0102928793414805, 1.0156738701557122, 1.0133935296385819, 1.0098062067635134, 1.0130728354188492, 1.0206089939343754, 1.0199118482524696, 1.0214742406116069, 1.009939253016269, 1.0140344908517149, 1.0130211329774619, 1.0091616533056991, 1.0068909995487438, 1.0096619433628085, 1.0008533065296457, 1.0000663650091846, 1.0030232275836013, 0.99883679351037302, 1.0148880458718934, 1.0095137020509564, 1.0209604817465139, 1.0140862753176014, 1.0077629864265525, 1.0098679597468192, 1.0091195362494569, 1.0059408753195767, 1.0146245044702051, 1.0100621889602885, 1.0138952973428978, 1.0021190476578505, 1.0124508875667464, 1.0110039651112739, 1.0043098563279325, 1.0062098822479, 1.0074498546697908, 1.0114844479562253, 1.021148738727391, 1.0166371278498569, 1.0100043148935127, 1.0062839515182835, 1.0227332751467522, 1.0031850292514011, 1.0126198360280616, 1.0080668716883741, 1.0045214336536801, 0.99970801067835979, 1.0115220566581609, 1.0201310785840458, 1.0037563582851252, 1.001139456557437, 1.0087679181641516, 1.0184426164126028, 1.0273457616708683, 1.0055938706936951, 0.99633195852013823, 1.0092706700333944, 0.99753100644141379, 1.009859722922255, 1.0003222869677935, 0.99849477081120053, 1.0028849183403303, 1.0032786769775617, 1.0008207050020264, 1.0146784589158486, 1.0233726696055965, 1.0269258207091174, 1.0166959693024413, 1.0251772507418615, 1.0117304565221577, 0.99721879343836051, 0.9974682791449786, 0.99857361952463741, 1.0043845133133833, 1.0151446589731472, 1.0227196286500857, 1.0028878164686512, 1.0007298667771238, 0.98729554983398515, 1.0098290710627156, 1.0055117143270054, 1.0018581918001626, 1.0095587081228039, 1.0199742673126708, 1.0070646805402752, 1.0173950564119925, 1.0043111369788571, 0.99906620187200346, 0.99517004994345726, 1.0078234525397263, 1.0056324823010865, 1.017269924989247, 1.01392558358624, 1.0068159963602921, 0.99176671442617204, 1.0007055900386908, 1.000611187691735, 1.0018701712446429, 1.0064978242125195, 1.0065520030783419, 1.0015322330274743, 1.000276716434199, 0.99315697847037987, 1.0015887613138337, 1.0161214942758294, 1.0252920562929611, 1.0212780928495047, 1.0157809995904872, 1.0076391639969784, 1.0127312839430229, 1.0062981411211664, 1.0141280561637556], 'Rp': [0.77838009620439386, 0.83494597789348102, 0.86244815122590146, 0.89913516112319103, 0.92690711750513521, 0.94075204343184382, 0.94959113304969789, 0.95641694789644827, 0.96135645035414841, 0.96537354085512339, 0.96809630802456981, 0.9708528857568961, 0.97323056138232911, 0.97526559421662595, 0.97713822276811713, 0.97835268440914103, 0.97975528647900523, 0.98075390479123259, 0.98178897616930572, 0.98248426271096057, 0.98320443063582608, 0.98408813562575448, 0.98450730927707142, 0.98456080898276022, 0.98495980424187135, 0.98528816339898684, 0.98522301328269946, 0.98537891826703405, 0.98553958827326349, 0.9857314741755987, 0.98593445222541709, 0.98580089805334692, 0.98591280293627448, 0.98580197586747309, 0.98582818701912966, 0.98580041738556301, 0.98606078323375668, 0.98624477658958121, 0.9863965982452827, 0.98643621635063827, 0.98635804029273955, 0.98629790499050474, 0.98627336957843781, 0.98631970553614479, 0.98632710179778793, 0.98619374062981058, 0.98657700350618716, 0.98654213802277135, 0.98657323941803865, 0.98643908600165742, 0.98643856399262997, 0.98635012199784045, 0.98645834712965463, 0.98673888939052035, 0.98689114697048264, 0.98677637407193031, 0.9867520063930848, 0.98697118313913013, 0.98693004406202944, 0.98694637654102202, 0.98696400058454115, 0.98704782022493698, 0.98707449111598711, 0.98687921535259759, 0.98689588041261223, 0.9869583079682146, 0.9868367254987277, 0.98680311748556748, 0.98685985738401005, 0.98685764905467477, 0.98680150484622497, 0.98681930778221216, 0.98700356661744715, 0.98692920469225087, 0.98711489720219014, 0.98706084220089907, 0.98705475046567126, 0.98701400637786862, 0.98701510622682875, 0.98701318578432429, 0.98697669908027152, 0.98710522265525413, 0.98701458680518295, 0.98683355576568343, 0.98703124651438667, 0.98703130798583516, 0.98714275217032577, 0.98704623307285078, 0.98708149567209591, 0.98707524733234442, 0.98701871287269738, 0.98703017510134983, 0.98707852188227352, 0.98704307518848355, 0.98694919576461615, 0.98695130328294534, 0.98693762512002314, 0.98707841616136205, 0.98702222329449985, 0.98703915100005657, 0.98708615716339065, 0.98711399663116306, 0.98708436301879943, 0.98719893331615238, 0.98721302528779087, 0.98716485480256699, 0.98721991743738613, 0.98701665183460729, 0.98708188256511775, 0.98693406260073169, 0.98702154112165286, 0.98710347311714919, 0.98707705875895735, 0.98708817838399221, 0.98712902146840309, 0.98702575164705797, 0.98708352522359999, 0.98702735011709841, 0.98717718830748435, 0.98704691793860699, 0.98706233984200598, 0.98714922629700264, 0.98712291939443553, 0.98710685606395021, 0.98706159240993807, 0.98693649954276164, 0.98699048733095818, 0.98708380007620344, 0.9871219220072196, 0.98691458877206972, 0.98716227638892073, 0.98704068885519958, 0.98710081507146874, 0.98714604562520913, 0.98720960351953357, 0.98705752180367889, 0.98694755963302738, 0.9871619868595406, 0.98719152617688066, 0.98709163854805204, 0.98697068052325243, 0.9868532968593966, 0.98713082098719729, 0.98725987547598804, 0.98709036140294804, 0.98723544314341216, 0.98707615923098868, 0.98720322703393781, 0.98722461508406523, 0.98717229351093383, 0.98716338210671428, 0.98719438477807631, 0.9870333555506009, 0.98691067981527736, 0.98685822170530157, 0.98698759397335756, 0.98688475629180372, 0.98705349461083192, 0.98723883878257324, 0.98723583153047501, 0.98722179620570405, 0.9871483901761281, 0.98700827541188185, 0.98691215351334671, 0.98716652840510422, 0.98719479935864041, 0.98736730519012095, 0.987078953011297, 0.98713189586774486, 0.98718702402675196, 0.98708091742846138, 0.98694934769309728, 0.98711174685256764, 0.9869820293712368, 0.98714860661992621, 0.98721598448670578, 0.98727136724028641, 0.9871044558199612, 0.98713816245121888, 0.98698503458188758, 0.98702634260056188, 0.98712182024743311, 0.98730900599687021, 0.98719397234882345, 0.98719904031454253, 0.98717881478069913, 0.98712023819650963, 0.98712374703814532, 0.98719004860957527, 0.98720159955906828, 0.98729303084172304, 0.98719034408089645, 0.98699897660363245, 0.98687945841392766, 0.98692972153694847, 0.98699981402050241, 0.98710436731199747, 0.98703991426882631, 0.98712708229825141, 0.98702090733367798]}



# Assemble the average performances and method names
methods = ['VB-NMF','G-NMF']
avr_performances = [
    vb_all_performances,
    gibbs_all_performances
]

for metric in metrics:
    plt.figure()
    plt.title("Performances (%s) for different fractions of missing values" % metric)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)
    
    x = iterations
    for method, avr_performance in zip(methods,avr_performances):
        y = avr_performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', marker=None, label=method)
    plt.legend(loc=0)  
    
    if metric == 'MSE':
        plt.ylim(0,MSE_max)
    elif metric == 'R^2' or metric == 'Rp':
        plt.ylim(0,1)