"""
Plot the convergence of the many different NMF algorithms in a single graph.

We run our method on the entire random dataset, so no test set.

We use a dataset of I=100, J=80, K=10, with unit mean priors and zero mean unit
variance noise.

We have the following methods:
- VB NMF
- Gibbs NMF

"""

import matplotlib.pyplot as plt
metrics = ['MSE']#,'R^2','Rp']
MSE_max = 10
iterations = range(1,200+1)

# VB NMF
vb_all_performances = {'R^2': [-560.4067225066677, -12.040601161232978, 0.6125568111794182, 0.6896401537920964, 0.6950793028184614, 0.7140342871871777, 0.7410966278984309, 0.7781626795018175, 0.8317152402073413, 0.8740801903589457, 0.8916897925909282, 0.904988983559727, 0.9186114441236645, 0.9297768535908805, 0.9392119051425584, 0.9455322274960668, 0.9488483961980763, 0.9510891702391907, 0.9533145191920473, 0.9560675762066344, 0.9592305757523639, 0.9620675754776621, 0.9642205111560448, 0.9658939285169069, 0.9673159266995018, 0.9685986668801774, 0.9697630709478591, 0.9707911424451949, 0.9716707002405175, 0.9724085949463058, 0.9730240585200274, 0.9735396143395467, 0.9739742219056378, 0.9743425958048924, 0.9746572300865158, 0.9749283681045833, 0.9751639933495717, 0.975370331381193, 0.9755523529325935, 0.9757141075398106, 0.9758589065125972, 0.9759894254783728, 0.9761077885799713, 0.9762156712093923, 0.9763144177145907, 0.9764051399103791, 0.976488777249096, 0.9765661290047637, 0.9766378754352022, 0.9767045968993483, 0.9767667919464558, 0.9768248923033684, 0.9768792739388815, 0.9769302652459878, 0.97697815367741, 0.9770231914176624, 0.9770656000116127, 0.9771055738858025, 0.9771432830066705, 0.9771788751824348, 0.9772124793863638, 0.9772442118330714, 0.9772741838426919, 0.9773025077587496, 0.9773292990347984, 0.9773546757632444, 0.9773787571218324, 0.9774016614146961, 0.9774235044107312, 0.977444398501196, 0.9774644524838504, 0.9774837713824996, 0.9775024559335984, 0.9775206017858611, 0.9775382986729755, 0.9775556297952209, 0.9775726715200446, 0.977589493396634, 0.9776061584133221, 0.9776227234045016, 0.9776392395203538, 0.9776557526947015, 0.9776723040732646, 0.9776889303881028, 0.9777056642783414, 0.9777225345601859, 0.9777395664421211, 0.9777567816670011, 0.9777741985436498, 0.9777918318058924, 0.9778096922045079, 0.9778277857148304, 0.9778461123289655, 0.9778646647965168, 0.9778834283602279, 0.9779023827246536, 0.9779215062564478, 0.9779407805156157, 0.9779601928179237, 0.9779797360755456, 0.9779994068447109, 0.9780192029710587, 0.9780391217466798, 0.9780591588737031, 0.9780793081530922, 0.9780995616777781, 0.9781199102981838, 0.9781403441738394, 0.9781608532929473, 0.9781814279085521, 0.9782020588860421, 0.9782227379744913, 0.9782434580094481, 0.978264213039165, 0.9782849983513299, 0.9783058103721504, 0.9783266464220302, 0.9783475043470142, 0.9783683820966493, 0.97838927736084, 0.9784101873720588, 0.9784311089079887, 0.9784520384307858, 0.978472972243756, 0.9784939065714328, 0.9785148375435133, 0.9785357611253496, 0.9785566730513858, 0.9785775687890964, 0.978598443518962, 0.9786192920863006, 0.978640108871247, 0.9786608875309081, 0.9786816205906295, 0.9787022988993043, 0.9787229110119886, 0.9787434426111645, 0.9787638761146943, 0.9787841906312404, 0.9788043623900651, 0.9788243656672124, 0.978844174067193, 0.9788637618754022, 0.9788831051673766, 0.978902182472727, 0.9789209749715775, 0.9789394663444119, 0.9789576424471536, 0.9789754909560127, 0.9789930010668642, 0.9790101632793312, 0.9790269692616818, 0.9790434117781205, 0.9790594846579054, 0.9790751827891755, 0.9790905021250187, 0.9791054396930254, 0.9791199936017715, 0.9791341630387125, 0.9791479482546906, 0.9791613505314684, 0.9791743721307908, 0.9791870162261969, 0.9791992868214591, 0.979211188661324, 0.9792227271406161, 0.979233908216747, 0.9792447383286335, 0.9792552243227515, 0.9792653733851899, 0.9792751929775999, 0.9792846907749191, 0.9792938746035061, 0.9793027523795113, 0.9793113320485853, 0.9793196215291512, 0.9793276286621637, 0.9793353611704398, 0.9793428266301231, 0.9793500324556599, 0.9793569858980201, 0.979363694054109, 0.9793701638838676, 0.9793764022308336, 0.9793824158420734, 0.9793882113843486, 0.9793937954547439, 0.9793991745853852, 0.9794043552429563, 0.9794093438243244, 0.9794141466497133, 0.979418769954682, 0.9794232198818075, 0.9794275024726006, 0.9794316236598997, 0.9794355892608024, 0.9794394049701097, 0.9794430763542528, 0.9794466088456971, 0.9794500077378512], 'MSE': [22075.771406156797, 512.78568405604187, 15.235135110399439, 12.204045202636996, 11.990165664440649, 11.244813168370229, 10.180661238393901, 8.7231409606322536, 6.6173341703770134, 4.9514493177620924, 4.2590002646213438, 3.7360462493876923, 3.2003805486705112, 2.7613316075501593, 2.390324220374326, 2.1417949707310475, 2.0113957801354214, 1.9232835194135989, 1.8357778077561986, 1.7275214316109733, 1.6031451957555614, 1.491588003965312, 1.406929744662814, 1.3411272210297815, 1.2852110633486409, 1.2347708426194548, 1.1889838632477674, 1.148557786297643, 1.1139716011850944, 1.0849559264634534, 1.0607545184332294, 1.0404817073632007, 1.0233919631621089, 1.0089066752844906, 0.99653454969495703, 0.98587279473832179, 0.97660748166430122, 0.96849380750284619, 0.96133631187869395, 0.95497575795288059, 0.94928193759958779, 0.94414963914800798, 0.9394953365380454, 0.93525314959885031, 0.93137021555384414, 0.92780281535110354, 0.92451400761775904, 0.92147236310669622, 0.91865113255481556, 0.91602749494713165, 0.91358184620888927, 0.91129720987234375, 0.90915880200127308, 0.90715370944671125, 0.90527062892292109, 0.90349964396923133, 0.90183204294456931, 0.90026018056128065, 0.89877737335781227, 0.89737780918353205, 0.89605641652027768, 0.89480862554879093, 0.89363005891173375, 0.89251629900977858, 0.8914628059502554, 0.89046493607489929, 0.88951800304751172, 0.88861735488423443, 0.8877584392924438, 0.88693683679580615, 0.88614826922239875, 0.88538860680066278, 0.8846538883472701, 0.88394035274026361, 0.88324447144979124, 0.88256297285427365, 0.8818928540144193, 0.88123138010018665, 0.88057607426907558, 0.87992470166528247, 0.87927525094897918, 0.87862591589922678, 0.87797507857404911, 0.87732129458646357, 0.87666328049287889, 0.87599990317546439, 0.87533017138005564, 0.87465323012887108, 0.87396835947789586, 0.87327498006007609, 0.87257266913066966, 0.87186119172613485, 0.87114054815691144, 0.87041102352483413, 0.86967319811832255, 0.86892786999980232, 0.86817588984095584, 0.86741798274373738, 0.86665464748066123, 0.86588616276094654, 0.86511266400137043, 0.86433423591623504, 0.86355098498660743, 0.86276308021441983, 0.8619707653596812, 0.86117435134607689, 0.86037419795550041, 0.85957069213729143, 0.85876422757778759, 0.85795518754913858, 0.85714393124476329, 0.85633078310956434, 0.85551602486585998, 0.85469989054970474, 0.85388256545977814, 0.85306419012561507, 0.85224486991494985, 0.8514246895261236, 0.85060372958755714, 0.84978208093738639, 0.84895985240099625, 0.84813717068711769, 0.84731417491171057, 0.8464910104370742, 0.84566782572302224, 0.84484477295853833, 0.84402201079503558, 0.84319970696372637, 0.84237803969369207, 0.8415571984992376, 0.84073738607401494, 0.83991882340373714, 0.83910175990517821, 0.83828648949851736, 0.83747337202580385, 0.83666285752789182, 0.83585550900169747, 0.83505201781631055, 0.8342532054659757, 0.83346000666941922, 0.83267343295026464, 0.83189452223836591, 0.83112428568964114, 0.83036366406765072, 0.82961350163625069, 0.82887453843516556, 0.82814741618437326, 0.82743269106069395, 0.8267308476631714, 0.82604231083424295, 0.82536745415002777, 0.82470660523292105, 0.82406004861061299, 0.82342802693052874, 0.82281074120250164, 0.82220835056018959, 0.82162097188540473, 0.82104867955319116, 0.82049150551461292, 0.81994943990599356, 0.81942243232556333, 0.81891039383642128, 0.81841319964791193, 0.81793069232270987, 0.81746268528674837, 0.81700896640341991, 0.81656930141394746, 0.81614343712567994, 0.81573110431982743, 0.81533202042326125, 0.81494589202711731, 0.81457241733564512, 0.8142112885988595, 0.81386219453598774, 0.8135248227062114, 0.81319886173939293, 0.81288400331159638, 0.81257994374433729, 0.81228638512666895, 0.81200303590592648, 0.81172961095770679, 0.81146583121578808, 0.81121142299967297, 0.81096611720611556, 0.81072964852532792, 0.81050175480529563, 0.81028217663385649, 0.81007065715316939, 0.80986694207871268, 0.80967077987133662, 0.80948192200566282, 0.80930012328552159, 0.80912514217101161, 0.80895674109638527, 0.80879468676912003, 0.80863875044789679, 0.80848870820037422, 0.8083443411419865, 0.80820543565601244, 0.80807178359375587], 'Rp': [0.021587326819517617, 0.68688777763711628, 0.82102204674967449, 0.8314233532042995, 0.8339687404149313, 0.84535578146293966, 0.86137940511244282, 0.88289465108340737, 0.91315948307977501, 0.93591595309514886, 0.94490221011790343, 0.95176155107281368, 0.95881861858582018, 0.9645597023258371, 0.96939121168314857, 0.97258126245804732, 0.97423396677048091, 0.97536624209334444, 0.97650289243667654, 0.97791629216195308, 0.97954057356636548, 0.98099203240573607, 0.98208703763249239, 0.98293502591698079, 0.98365451842050189, 0.98430223751235413, 0.98488786591170308, 0.98540224674829646, 0.98584014062724001, 0.98620598804682802, 0.98651026377772255, 0.98676479985014764, 0.98697919552619795, 0.98716073988404407, 0.98731566561888995, 0.98744910172128408, 0.98756503002557061, 0.98766654041397173, 0.98775609272222431, 0.98783568768020702, 0.98790695854531552, 0.98797122203993937, 0.98802952078774953, 0.98808267635379787, 0.98813134982793982, 0.98817609027721087, 0.98821736176803987, 0.98825555683405952, 0.98829100645004331, 0.98832399066892285, 0.98835474929081357, 0.9883834905312443, 0.98841039689494103, 0.9884356289217775, 0.98845932776320033, 0.988481617087975, 0.98850260452359484, 0.98852238311821727, 0.98854103356330902, 0.9885586273736563, 0.98857523033689798, 0.98859090524258653, 0.98860571321235635, 0.98861971382252611, 0.98863296513042354, 0.98864552430689523, 0.98865744832743474, 0.98866879401544527, 0.98867961756225575, 0.98868997402616576, 0.98869991699314297, 0.98870949826436128, 0.98871876744943321, 0.98872777149978652, 0.98873655429744878, 0.98874515639100169, 0.98875361490561708, 0.98876196360384694, 0.98877023305085276, 0.98877845083538518, 0.98878664180689546, 0.98879482830212784, 0.9888030303479205, 0.98881126583739654, 0.98881955068305427, 0.98882789895192513, 0.98883632298584079, 0.98884483350513053, 0.9888534396843236, 0.9888621491670293, 0.98887096794655105, 0.98887989998919323, 0.98888894649570958, 0.98889810493765462, 0.98890736848645289, 0.98891672669209807, 0.98892616762007324, 0.98893568048007474, 0.98894525737431249, 0.98895489356293875, 0.98896458662638265, 0.98897433526207712, 0.98898413825665799, 0.98899399384784636, 0.98900389946987433, 0.9890138517818472, 0.98902384686052858, 0.98903388045656182, 0.98904394824720199, 0.98905404605353153, 0.98906417001492719, 0.98907431672432922, 0.98908448332562215, 0.98909466756639575, 0.98910486779127837, 0.98911508285874128, 0.98912531197363118, 0.98913555445133039, 0.98914580946417252, 0.98915607584759691, 0.98916635203650594, 0.98917663614835316, 0.98918692615559711, 0.98919722004945343, 0.98920751592020151, 0.98921781194155467, 0.98922810629949098, 0.98923839711742756, 0.98924868240789088, 0.989258960047253, 0.98926922774586878, 0.98927948297751567, 0.98928972283862737, 0.9892999438250959, 0.98931014153864583, 0.98932031036153856, 0.98933044316035201, 0.98934053109341957, 0.98935056359829743, 0.98936052861772594, 0.98937041307281481, 0.98938020351356049, 0.98938988680685014, 0.98939945070531132, 0.98940888419481776, 0.98941817760698902, 0.98942732255537202, 0.98943631178028757, 0.98944513897474662, 0.98945379863422855, 0.98946228594623753, 0.9894705967181131, 0.98947872733481546, 0.98948667473701102, 0.98949443641169255, 0.98950201038965413, 0.98950939524598425, 0.98951659010012227, 0.9895235946129376, 0.98953040897768929, 0.98953703390293668, 0.9895434705862366, 0.98954972067889124, 0.9895557862437665, 0.98956166970897108, 0.9895673738205194, 0.98957290159681111, 0.9895782562863964, 0.98958344132960552, 0.98958846032361159, 0.98959331698981357, 0.98959801514260948, 0.98960255865888347, 0.98960695144794475, 0.98961119742267778, 0.98961530047265855, 0.98961926444087434, 0.98962309310530916, 0.98962679016667887, 0.98963035924294251, 0.98963380387021482, 0.98963712750923671, 0.98964033355527881, 0.98964342534960303, 0.98964640619019972, 0.98964927934035996, 0.98965204803413354, 0.98965471547858719, 0.98965728485322468, 0.98965975930734185, 0.98966214195598257, 0.98966443587538155, 0.98966664409811955, 0.98966876960856942, 0.98967081533859791, 0.98967278416362781, 0.98967467889903449, 0.98967650229688353, 0.98967825704296186, 0.98967994575410645]}

# Gibbs NMF
gibbs_all_performances = {'R^2': [0.5874084878121256, 0.6968575094174961, 0.7438150501278078, 0.8081103649542194, 0.8588449597144766, 0.8846677603553285, 0.9014806302366201, 0.9143249929550229, 0.9240016742523642, 0.9316092583881211, 0.9368493082653059, 0.9423049007709001, 0.9470821306681992, 0.951006618301034, 0.9545801753260581, 0.9570420167437889, 0.959813595486564, 0.9617482162402421, 0.9638261428596557, 0.965156140364875, 0.9665798513942868, 0.9683231488858309, 0.9691834804363861, 0.9693256894861841, 0.9701097222512446, 0.9707695915035803, 0.9706317053661928, 0.9708937783680278, 0.9712771298873855, 0.9715887504577357, 0.9720486620879139, 0.9717835059703902, 0.9719902288224801, 0.9717587542492996, 0.9718502531429035, 0.9717937436145887, 0.9722996105699292, 0.9726734319534867, 0.9729412502494873, 0.9730288621470177, 0.9728678952626644, 0.972782719067991, 0.9727218629086913, 0.9727862306820765, 0.9728219826333189, 0.9725745610346578, 0.9733314299291049, 0.9732612319477381, 0.973316959388951, 0.9730614134520519, 0.9730523075210362, 0.972861114632972, 0.9730989978412297, 0.9736434793589386, 0.9739515964775993, 0.9737273606044639, 0.9736705897545364, 0.974110772234789, 0.9740215476598245, 0.9740369877881883, 0.9740929186756776, 0.9742603518322159, 0.9743155846252362, 0.9739297415393755, 0.9739616743257331, 0.9740771634017203, 0.973831642717771, 0.9737776638251673, 0.9738758110852178, 0.973874812328321, 0.9737645771199395, 0.9738047741552153, 0.9741565600679803, 0.9740198205069471, 0.974395266737997, 0.974285982460653, 0.9742700271413154, 0.9741955232538795, 0.97417248184823, 0.9741876101410045, 0.9741205809646545, 0.9743646603926195, 0.9741958780257791, 0.973838418991211, 0.9742293679263851, 0.9742185217640112, 0.974449884321389, 0.9742595327903472, 0.9743112209015388, 0.9743073433889272, 0.9741704999526878, 0.9742284910630489, 0.9743197199103137, 0.9742366466054992, 0.9740449953161897, 0.9740627243579155, 0.9740229913149574, 0.9743163364244402, 0.9742121908428981, 0.9742379614450866, 0.9743361114844777, 0.974393856251815, 0.9743233886583487, 0.974547400215783, 0.9745674128464484, 0.9744922171716852, 0.9745986819555789, 0.9741904841710205, 0.974327158568242, 0.9740360566649877, 0.9742108739173541, 0.9743716808412197, 0.9743181494764056, 0.9743371825590994, 0.9744180187655346, 0.9741971862659029, 0.9743132100528112, 0.9742157306590223, 0.9745152112804452, 0.9742524632987778, 0.9742892598382283, 0.9744594970454822, 0.9744111776773939, 0.9743796440634348, 0.9742770407273198, 0.9740312691206398, 0.9741460034431412, 0.9743146818423831, 0.9744092940292278, 0.9739909729343131, 0.9744881024097435, 0.974248166787449, 0.9743639527656875, 0.9744541164437891, 0.9745765261193966, 0.9742760843042031, 0.9740571491334008, 0.9744735729985444, 0.9745401231632039, 0.9743461245232651, 0.974100088245077, 0.9738736732533884, 0.9744268434052776, 0.9746623821623084, 0.9743333390910394, 0.9746318892952087, 0.9743183589462627, 0.9745609045208568, 0.9746073799004449, 0.9744957345001413, 0.9744857208638376, 0.9745482293019533, 0.9741958141558219, 0.9739747125581331, 0.9738843527297539, 0.9741445070520781, 0.9739288204367405, 0.9742707845082201, 0.9746398291526907, 0.974633484506776, 0.9746053747067431, 0.9744575984511934, 0.9741839582690497, 0.9739913199769975, 0.9744956607981314, 0.9745505393997153, 0.9748921861628295, 0.9743191384506201, 0.9744289327155766, 0.9745218450795281, 0.9743260140233551, 0.9740611369850729, 0.9743894393879862, 0.9741267286381011, 0.9744594644773773, 0.9745928478946054, 0.9746919305424708, 0.9743701431335766, 0.9744258614773732, 0.9741299108427287, 0.9742149604526138, 0.9743957636503576, 0.9747784804257431, 0.9745511567790089, 0.9745535575156005, 0.9745215404314803, 0.9744038550542495, 0.9744024772369615, 0.9745301345042953, 0.9745620634205137, 0.9747431247606514, 0.9745286969391298, 0.9741591164687059, 0.9739259008283162, 0.9740279795289692, 0.9741677755548058, 0.9743748297569736, 0.9742453325667317, 0.974408933174864, 0.9742098113928572], 'MSE': [16.224023585809295, 11.920242592949917, 10.073766779679207, 7.5455308044181733, 5.5505327550349355, 4.5351223205661295, 3.8740025703008594, 3.3689334219244653, 2.9884246112416695, 2.6892773413546744, 2.4832268282274184, 2.2687006955496773, 2.0808493020064143, 1.9265296467626749, 1.786009370056578, 1.6892042442943216, 1.58021955225772, 1.5041459254135103, 1.4224371905338726, 1.3701387058187549, 1.3141551951593384, 1.245604828066436, 1.2117746620171952, 1.2061826832442846, 1.1753527565573874, 1.149405217654623, 1.1548272098164771, 1.144521911628378, 1.1294476701377245, 1.1171940504343618, 1.0991092936834748, 1.1095358268950097, 1.1014070207296887, 1.1105091200794335, 1.1069111783766763, 1.1091332597649719, 1.0892414365638476, 1.0745419413862711, 1.0640107253464988, 1.0605656290467909, 1.066895207942955, 1.0702445269437375, 1.0726375276106239, 1.0701064424023308, 1.0687005954979192, 1.0784297676542494, 1.0486679852807801, 1.0514283273424332, 1.0492369993729802, 1.0592856387294327, 1.0596437043590099, 1.0671618375095056, 1.0578077362557627, 1.0363975018607183, 1.0242816457350434, 1.0330991031646524, 1.0353314603048311, 1.0180224979759429, 1.0215310083691465, 1.0209238678940211, 1.0187245399607114, 1.0121406927402012, 1.0099688154470439, 1.0251410309204765, 1.023885362144648, 1.0193440726673531, 1.0289984965940016, 1.0311210677106335, 1.0272616973287809, 1.0273009706898952, 1.0316356663099853, 1.0300550287323118, 1.0162220176856422, 1.0215989238938026, 1.0068355360687433, 1.0111328389477712, 1.0117602378874162, 1.0146898978326333, 1.0155959375781587, 1.0150010591777645, 1.0176367967194124, 1.0080390462104019, 1.0146759474058871, 1.0287320383250662, 1.0133590494056415, 1.0137855448350725, 1.0046878501979115, 1.0121728993033594, 1.0101404068494277, 1.0102928793414805, 1.0156738701557122, 1.0133935296385819, 1.0098062067635134, 1.0130728354188492, 1.0206089939343754, 1.0199118482524696, 1.0214742406116069, 1.009939253016269, 1.0140344908517149, 1.0130211329774619, 1.0091616533056991, 1.0068909995487438, 1.0096619433628085, 1.0008533065296457, 1.0000663650091846, 1.0030232275836013, 0.99883679351037302, 1.0148880458718934, 1.0095137020509564, 1.0209604817465139, 1.0140862753176014, 1.0077629864265525, 1.0098679597468192, 1.0091195362494569, 1.0059408753195767, 1.0146245044702051, 1.0100621889602885, 1.0138952973428978, 1.0021190476578505, 1.0124508875667464, 1.0110039651112739, 1.0043098563279325, 1.0062098822479, 1.0074498546697908, 1.0114844479562253, 1.021148738727391, 1.0166371278498569, 1.0100043148935127, 1.0062839515182835, 1.0227332751467522, 1.0031850292514011, 1.0126198360280616, 1.0080668716883741, 1.0045214336536801, 0.99970801067835979, 1.0115220566581609, 1.0201310785840458, 1.0037563582851252, 1.001139456557437, 1.0087679181641516, 1.0184426164126028, 1.0273457616708683, 1.0055938706936951, 0.99633195852013823, 1.0092706700333944, 0.99753100644141379, 1.009859722922255, 1.0003222869677935, 0.99849477081120053, 1.0028849183403303, 1.0032786769775617, 1.0008207050020264, 1.0146784589158486, 1.0233726696055965, 1.0269258207091174, 1.0166959693024413, 1.0251772507418615, 1.0117304565221577, 0.99721879343836051, 0.9974682791449786, 0.99857361952463741, 1.0043845133133833, 1.0151446589731472, 1.0227196286500857, 1.0028878164686512, 1.0007298667771238, 0.98729554983398515, 1.0098290710627156, 1.0055117143270054, 1.0018581918001626, 1.0095587081228039, 1.0199742673126708, 1.0070646805402752, 1.0173950564119925, 1.0043111369788571, 0.99906620187200346, 0.99517004994345726, 1.0078234525397263, 1.0056324823010865, 1.017269924989247, 1.01392558358624, 1.0068159963602921, 0.99176671442617204, 1.0007055900386908, 1.000611187691735, 1.0018701712446429, 1.0064978242125195, 1.0065520030783419, 1.0015322330274743, 1.000276716434199, 0.99315697847037987, 1.0015887613138337, 1.0161214942758294, 1.0252920562929611, 1.0212780928495047, 1.0157809995904872, 1.0076391639969784, 1.0127312839430229, 1.0062981411211664, 1.0141280561637556], 'Rp': [0.77838009620439386, 0.83494597789348102, 0.86244815122590146, 0.89913516112319103, 0.92690711750513521, 0.94075204343184382, 0.94959113304969789, 0.95641694789644827, 0.96135645035414841, 0.96537354085512339, 0.96809630802456981, 0.9708528857568961, 0.97323056138232911, 0.97526559421662595, 0.97713822276811713, 0.97835268440914103, 0.97975528647900523, 0.98075390479123259, 0.98178897616930572, 0.98248426271096057, 0.98320443063582608, 0.98408813562575448, 0.98450730927707142, 0.98456080898276022, 0.98495980424187135, 0.98528816339898684, 0.98522301328269946, 0.98537891826703405, 0.98553958827326349, 0.9857314741755987, 0.98593445222541709, 0.98580089805334692, 0.98591280293627448, 0.98580197586747309, 0.98582818701912966, 0.98580041738556301, 0.98606078323375668, 0.98624477658958121, 0.9863965982452827, 0.98643621635063827, 0.98635804029273955, 0.98629790499050474, 0.98627336957843781, 0.98631970553614479, 0.98632710179778793, 0.98619374062981058, 0.98657700350618716, 0.98654213802277135, 0.98657323941803865, 0.98643908600165742, 0.98643856399262997, 0.98635012199784045, 0.98645834712965463, 0.98673888939052035, 0.98689114697048264, 0.98677637407193031, 0.9867520063930848, 0.98697118313913013, 0.98693004406202944, 0.98694637654102202, 0.98696400058454115, 0.98704782022493698, 0.98707449111598711, 0.98687921535259759, 0.98689588041261223, 0.9869583079682146, 0.9868367254987277, 0.98680311748556748, 0.98685985738401005, 0.98685764905467477, 0.98680150484622497, 0.98681930778221216, 0.98700356661744715, 0.98692920469225087, 0.98711489720219014, 0.98706084220089907, 0.98705475046567126, 0.98701400637786862, 0.98701510622682875, 0.98701318578432429, 0.98697669908027152, 0.98710522265525413, 0.98701458680518295, 0.98683355576568343, 0.98703124651438667, 0.98703130798583516, 0.98714275217032577, 0.98704623307285078, 0.98708149567209591, 0.98707524733234442, 0.98701871287269738, 0.98703017510134983, 0.98707852188227352, 0.98704307518848355, 0.98694919576461615, 0.98695130328294534, 0.98693762512002314, 0.98707841616136205, 0.98702222329449985, 0.98703915100005657, 0.98708615716339065, 0.98711399663116306, 0.98708436301879943, 0.98719893331615238, 0.98721302528779087, 0.98716485480256699, 0.98721991743738613, 0.98701665183460729, 0.98708188256511775, 0.98693406260073169, 0.98702154112165286, 0.98710347311714919, 0.98707705875895735, 0.98708817838399221, 0.98712902146840309, 0.98702575164705797, 0.98708352522359999, 0.98702735011709841, 0.98717718830748435, 0.98704691793860699, 0.98706233984200598, 0.98714922629700264, 0.98712291939443553, 0.98710685606395021, 0.98706159240993807, 0.98693649954276164, 0.98699048733095818, 0.98708380007620344, 0.9871219220072196, 0.98691458877206972, 0.98716227638892073, 0.98704068885519958, 0.98710081507146874, 0.98714604562520913, 0.98720960351953357, 0.98705752180367889, 0.98694755963302738, 0.9871619868595406, 0.98719152617688066, 0.98709163854805204, 0.98697068052325243, 0.9868532968593966, 0.98713082098719729, 0.98725987547598804, 0.98709036140294804, 0.98723544314341216, 0.98707615923098868, 0.98720322703393781, 0.98722461508406523, 0.98717229351093383, 0.98716338210671428, 0.98719438477807631, 0.9870333555506009, 0.98691067981527736, 0.98685822170530157, 0.98698759397335756, 0.98688475629180372, 0.98705349461083192, 0.98723883878257324, 0.98723583153047501, 0.98722179620570405, 0.9871483901761281, 0.98700827541188185, 0.98691215351334671, 0.98716652840510422, 0.98719479935864041, 0.98736730519012095, 0.987078953011297, 0.98713189586774486, 0.98718702402675196, 0.98708091742846138, 0.98694934769309728, 0.98711174685256764, 0.9869820293712368, 0.98714860661992621, 0.98721598448670578, 0.98727136724028641, 0.9871044558199612, 0.98713816245121888, 0.98698503458188758, 0.98702634260056188, 0.98712182024743311, 0.98730900599687021, 0.98719397234882345, 0.98719904031454253, 0.98717881478069913, 0.98712023819650963, 0.98712374703814532, 0.98719004860957527, 0.98720159955906828, 0.98729303084172304, 0.98719034408089645, 0.98699897660363245, 0.98687945841392766, 0.98692972153694847, 0.98699981402050241, 0.98710436731199747, 0.98703991426882631, 0.98712708229825141, 0.98702090733367798]}

# Non-probabilistic NMF
np_all_performances = {'R^2': [0.29896630985443795, 0.6029746265568162, 0.631614383489399, 0.6481233757519593, 0.6607548292076648, 0.6712089938271184, 0.6803246885916399, 0.6886406576123596, 0.6965251250179424, 0.7042356713740292, 0.711951873227887, 0.719793663949166, 0.7278325335139995, 0.7360993845248691, 0.7445905054084361, 0.7532719934344667, 0.7620833284023394, 0.7709418885464703, 0.7797504166285718, 0.7884078700123761, 0.796821592451683, 0.8049173162278968, 0.8126443178211892, 0.8199753284542842, 0.8269027578908268, 0.8334333955222379, 0.8395832594184209, 0.8453734407329689, 0.8508271514293544, 0.8559678421618915, 0.8608181328011584, 0.8653992898602425, 0.869731029079896, 0.8738314838045672, 0.8777172417034211, 0.8814034029718727, 0.8849036474169373, 0.8882303155884208, 0.8913945134452721, 0.8944062456720191, 0.8972745746420527, 0.9000077942735795, 0.9026136032733546, 0.9050992615142092, 0.9074717161660284, 0.9097376894369537, 0.9119037258120603, 0.9139762021051165, 0.9159613075464235, 0.917865003161746, 0.9196929699753085, 0.9214505545087421, 0.9231427181686549, 0.9247739949123921, 0.9263484594609154, 0.9278697065992529, 0.9293408409909871, 0.9307644765633967, 0.9321427448996292, 0.9334773130366497, 0.934769412242694, 0.9360198801948816, 0.9372292189148865, 0.9383976694471131, 0.9395253015999184, 0.940612113688414, 0.9416581341379643, 0.942663515137038, 0.9436286089765301, 0.9445540202473514, 0.9454406309153015, 0.9462895992968792, 0.9471023370918287, 0.947880470352522, 0.9486257906161006, 0.9493402017971815, 0.9500256673378652, 0.9506841609275934, 0.9513176230452094, 0.9519279246978324, 0.9525168390190015, 0.9530860208093866, 0.95363699363667, 0.9541711437506065, 0.9546897198142874, 0.9551938373006434, 0.9556844863466178, 0.956162541884042, 0.9566287749617114, 0.9570838643221694, 0.9575284074836433, 0.9579629307860117, 0.9583878980726506, 0.9588037178804075, 0.959210749182451, 0.9596093058616252, 0.9599996601787649, 0.9603820455409567, 0.9607566588742087, 0.961123662872752, 0.9614831883442178, 0.9618353368068131, 0.9621801834299369, 0.9625177803492133, 0.9628481603340141, 0.9631713407416403, 0.9634873276580701, 0.9637961201009596, 0.9640977141469882, 0.964392106843248, 0.9646792997713811, 0.964959302152939, 0.9652321334131222, 0.9654978251547166, 0.9657564225307563, 0.9660079850391415, 0.9662525867913536, 0.9664903163278905, 0.9667212760638165, 0.9669455814491809, 0.9671633599226586, 0.9673747497250632, 0.9675798986252738, 0.9677789625971969, 0.9679721044746629, 0.9681594926027778, 0.9683412994994877, 0.9685177005394885, 0.9686888726732058, 0.9688549931952166, 0.9690162385781512, 0.9691727833889315, 0.9693247993037396, 0.9694724542361867, 0.9696159115899604, 0.9697553296431172, 0.9698908610666109, 0.9700226525750718, 0.9701508447036649, 0.9702755717013603, 0.9703969615282944, 0.9705151359431683, 0.9706302106657675, 0.9707422955995967, 0.9708514951001761, 0.9709579082755699, 0.9710616293070696, 0.9711627477795005, 0.9712613490122344, 0.9713575143835909, 0.9714513216428386, 0.9715428452054032, 0.9716321564281427, 0.9717193238626498, 0.971804413485475, 0.9718874889049511, 0.9719686115449433, 0.9720478408063574, 0.9721252342076416, 0.9722008475057997, 0.9722747347996412, 0.972346948617104, 0.9724175399885465, 0.9724865585078928, 0.9725540523834584, 0.9726200684802042, 0.9726846523550278, 0.9727478482865769, 0.9728096993009044, 0.9728702471941265, 0.9729295325530867, 0.9729875947748653, 0.9730444720858284, 0.9731002015607653, 0.9731548191425394, 0.9732083596625627, 0.9732608568622978, 0.973312343415911, 0.973362850954122, 0.9734124100892311, 0.9734610504412609, 0.9735088006651036, 0.9735556884785345, 0.9736017406909291, 0.9736469832325048, 0.9736914411838963, 0.9737351388058691, 0.9737780995689693, 0.9738203461829176, 0.9738619006255517, 0.9739027841711352, 0.973943017417856, 0.9739826203143535, 0.9740216121851238, 0.9740600117546686, 0.9740978371702692, 0.9741351060232877, 0.9741718353689094, 0.9742080417442687, 0.9742437411849132], 'MSE': [27.566216917689612, 15.611928099902054, 14.485748626402636, 13.836578025617813, 13.339880946946206, 12.92879974836179, 12.570350186284298, 12.243347634012737, 11.933312692984982, 11.630116717679352, 11.326698355517674, 11.018341557428528, 10.702235177218471, 10.377164055252083, 10.043274138917065, 9.7018985596004779, 9.3554171073205357, 9.007078655197347, 8.6607075759609842, 8.320277092679671, 7.9894306567558697, 7.6710886414463557, 7.3672456093093359, 7.0789738298234948, 6.8065717681050781, 6.5497724500567163, 6.3079460092457946, 6.0802630942115075, 5.8658109584922267, 5.6636674697671019, 5.4729431639949935, 5.2928017941865066, 5.1224680931984174, 4.9612290172590265, 4.8084323020152953, 4.6634841739180235, 4.5258467122754116, 4.3950346589927136, 4.27061130285652, 4.1521832372335021, 4.0393941092775778, 3.9319177835239505, 3.829451529556962, 3.7317098728950522, 3.6384196352377876, 3.5493164842850233, 3.4641430762061662, 3.3826486603824457, 3.3045898623977314, 3.229732281350036, 3.1578525266259265, 3.0887403610041155, 3.0222006908497439, 2.9580552307916075, 2.8961437536630354, 2.836324904454631, 2.7784766008314508, 2.7224960573105976, 2.6682994552621531, 2.6158212430539711, 2.5650130044576245, 2.5158418001301106, 2.4682878894532969, 2.4223417940206238, 2.3780007688109253, 2.3352648800777933, 2.2941330100721515, 2.2545991744020935, 2.2166495201995398, 2.1802602735939485, 2.1453967537120788, 2.1120134129514194, 2.080054740111986, 2.0494567951677332, 2.0201491308603394, 1.9920568809971293, 1.9651028386312583, 1.9392093938674426, 1.9143002427256264, 1.8903018130097353, 1.8671443811323716, 1.8447628766199491, 1.8230973893742621, 1.8020934089459797, 1.7817018351019618, 1.761878804944871, 1.7425853840695056, 1.7237871681940318, 1.705453837950565, 1.6875587036600646, 1.6700782695657774, 1.6529918388032396, 1.6362811720106383, 1.6199302046028976, 1.6039248209499541, 1.5882526784744171, 1.5729030712696686, 1.5578668212455935, 1.5431361848299048, 1.5287047645205603, 1.5145674166681291, 1.500720149349037, 1.4871600067339379, 1.4738849387331618, 1.4608936567815201, 1.4481854783510049, 1.4357601641273083, 1.4236177527383969, 1.4117583984580295, 1.400182217401174, 1.388889147374111, 1.3778788257647578, 1.3671504887306631, 1.3567028935794094, 1.3465342647924301, 1.3366422627788548, 1.3270239733090239, 1.3176759147719832, 1.308594059977719, 1.2997738691713738, 1.2912103311784411, 1.2828980100600846, 1.2748310952125887, 1.2670034533921402, 1.2594086816073307, 1.2520401601510449, 1.2448911052307394, 1.2379546207200467, 1.2312237485313857, 1.2246915170443633, 1.2183509869593883, 1.2121952939135752, 1.2062176872144319, 1.2004115641221749, 1.1947704992373438, 1.1892882687117847, 1.1839588691811915, 1.1787765314972667, 1.1737357295021398, 1.1688311842252213, 1.1640578639869734, 1.1594109809621929, 1.1548859847893949, 1.1504785538162838, 1.1461845845497693, 1.1420001798384956, 1.137921636262863, 1.1339454311466219, 1.1300682095407231, 1.1262867714671372, 1.1225980596502469, 1.1189991479086288, 1.1154872303305887, 1.1120596113137569, 1.1087136965122113, 1.1054469847036341, 1.1022570605639042, 1.0991415883161766, 1.096098306206073, 1.093125021743161, 1.0902196076409201, 1.0873799983830257, 1.0846041873413357, 1.0818902243715398, 1.0792362138145399, 1.0766403128349811, 1.0741007300334733, 1.0716157242742799, 1.069183603676511, 1.066802724723146, 1.0644714914484654, 1.0621883546709183, 1.0599518112440509, 1.0577604033040173, 1.0556127174968024, 1.053507384173175, 1.0514430765431571, 1.0494185097852413, 1.0474324401085999, 1.0454836637689278, 1.0435710160405014, 1.0416933701486986, 1.0398496361684353, 1.0380387598949348, 1.0362597216938956, 1.034511535338517, 1.0327932468410799, 1.0311039332870877, 1.0294427016793848, 1.0278086878000976, 1.0262010550974729, 1.0246189936045667, 1.0230617188961417, 1.0215284710896626, 1.0200185138957416, 1.0185311337225682, 1.0170656388383383, 1.015621358594915, 1.0141976427150854, 1.0127938606451461], 'Rp': [0.72130873106978022, 0.77994665433697052, 0.79688333847802839, 0.80667409652733535, 0.81398198368537789, 0.82000696558939146, 0.82528395820090417, 0.83012587284211303, 0.83473852856452291, 0.83926397248620321, 0.84380022313556979, 0.84841133630088006, 0.85313336508351023, 0.85797867925206128, 0.86293947648158253, 0.86799061330474947, 0.87309210244366353, 0.8781922564823883, 0.88323254109012339, 0.88815422580417713, 0.89290547258851682, 0.89744678430789693, 0.90175336967196285, 0.90581439974019173, 0.90963024478720012, 0.9132090361320645, 0.91656351810166725, 0.91970862762220484, 0.9226598589139029, 0.92543228550751044, 0.92804005782996091, 0.93049620544293021, 0.93281260925026499, 0.93500005127704144, 0.93706828822892829, 0.93902612492965798, 0.94088148309855513, 0.94264147041799362, 0.94431245668497832, 0.94590016095599572, 0.94740974883451523, 0.94884593467430023, 0.95021308085947076, 0.95151528594205936, 0.95275645499823303, 0.95394034838109587, 0.95507060823751644, 0.95615076497470841, 0.9571842278328011, 0.95817426467992139, 0.95912397617915213, 0.96003626882166138, 0.96091383026000898, 0.96175910917384122, 0.96257430076780703, 0.96336133809535052, 0.96412188883198202, 0.96485735694740749, 0.96556888894453208, 0.96625738485092172, 0.96692351476750715, 0.96756774221717601, 0.96819035549048971, 0.96879150745584786, 0.96937126290597486, 0.96992965075898796, 0.97046671685659724, 0.97098257227591767, 0.97147743235358675, 0.97195164297926051, 0.97240569273477873, 0.97284021153099021, 0.97325595799412878, 0.97365379871144986, 0.97403468258685844, 0.97439961320119517, 0.9747496214810214, 0.97508574035655005, 0.97540898253766872, 0.9757203220846361, 0.9760206800854071, 0.97631091445632368, 0.97659181364670822, 0.97686409384578388, 0.97712839916342953, 0.97738530418179892, 0.97763531824989547, 0.97787889090987024, 0.97811641789640891, 0.97834824722934866, 0.97857468501772815, 0.97879600070180006, 0.97901243156972584, 0.97922418648872389, 0.97943144887880096, 0.97963437902482964, 0.97983311586652155, 0.9800277784257756, 0.98021846702962168, 0.98040526446981358, 0.9805882372120075, 0.98076743673495459, 0.98094290104629434, 0.98111465639047768, 0.98128271913722231, 0.98144709781619643, 0.98160779524618469, 0.98176481069457833, 0.98191814199633698, 0.98206778756008895, 0.98221374819421436, 0.98235602869554695, 0.98249463915870172, 0.98262959598140198, 0.98276092256039671, 0.98288864969043632, 0.98301281569326249, 0.9831334663144593, 0.9832506544311107, 0.98336443961406261, 0.98347488758500712, 0.9835820696026073, 0.98368606180459883, 0.9837869445255627, 0.98388480160396552, 0.98397971968792319, 0.98407178754670321, 0.98416109539386865, 0.98424773422886114, 0.98433179520419423, 0.98441336902651366, 0.98449254540024811, 0.98456941252223829, 0.9846440566347836, 0.98471656164287014, 0.9847870087993168, 0.98485547645900895, 0.98492203990124105, 0.9849867712169712, 0.98504973925578521, 0.98511100962646003, 0.98517064474363658, 0.98522870391295891, 0.98528524344697255, 0.98534031680430401, 0.98539397474519541, 0.98544626549721137, 0.98549723492563956, 0.98554692670418131, 0.98559538248187828, 0.98564264204374263, 0.98568874346240298, 0.98573372323953046, 0.98577761643582074, 0.98582045678905417, 0.98586227682009175, 0.98590310792696589, 0.9859429804675478, 0.98598192383139305, 0.98601996650163559, 0.98605713610769286, 0.98609345946994809, 0.98612896263713412, 0.98616367091760382, 0.9861976089053287, 0.98623080050150969, 0.98626326893270344, 0.98629503676614849, 0.98632612592302005, 0.98635655769017538, 0.98638635273088859, 0.98641553109509506, 0.98644411222932737, 0.98647211498682319, 0.98649955763783737, 0.9865264578804096, 0.98655283285170869, 0.98657869913993623, 0.98660407279683848, 0.98662896935085587, 0.98665340382083078, 0.98667739073019378, 0.98670094412164411, 0.98672407757210201, 0.98674680420800731, 0.98676913672071853, 0.98679108738194732, 0.98681266805923729, 0.98683389023118229, 0.98685476500246661, 0.98687530311859917, 0.98689551498007233, 0.98691541065618116, 0.98693499989811206, 0.98695429215148955, 0.98697329656809785, 0.98699202201693659, 0.98701047709433376, 0.98702867013336848, 0.98704660921233189]}


# Assemble the average performances and method names
methods = ['VB-NMF','G-NMF', 'NP-NMF']
avr_performances = [
    vb_all_performances,
    gibbs_all_performances,
    np_all_performances
]

for metric in metrics:
    plt.figure()
    #plt.title("Performances (%s) for different fractions of missing values" % metric)
    plt.xlabel("Iterations", fontsize=16)
    plt.ylabel(metric, fontsize=16)
    
    x = iterations
    for method, avr_performance in zip(methods,avr_performances):
        y = avr_performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', marker=None, label=method)
    plt.legend(loc=0)  
    
    if metric == 'MSE':
        plt.ylim(0,MSE_max)
    elif metric == 'R^2' or metric == 'Rp':
        plt.ylim(0,1)